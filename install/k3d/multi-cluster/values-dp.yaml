# Helm values for OpenChoreo Data Plane in k3d multi-cluster setup
# This file contains overrides specific to running the data plane in a k3d environment

# Cluster Agent configuration for secure communication with control plane
# IMPORTANT: Before installing, create the server CA ConfigMap manually.
# See the README for instructions on extracting and creating CA resources.
clusterAgent:
  serverUrl: "wss://cluster-gateway.openchoreo.localhost:8443/ws"

  tls:
    generateCerts: true
    caSecretName: ""

fluent-bit:
  enabled: true

  config:
    outputs: |
      [OUTPUT]
          Name opensearch
          Host host.k3d.internal
          Generate_ID On
          HTTP_Passwd ThisIsTheOpenSearchPassword1
          HTTP_User admin
          Logstash_Format On
          Logstash_DateFormat %Y-%m-%d
          Logstash_Prefix container-logs
          Match kube.*
          Port 11085
          Replace_Dots On
          Suppress_Type_Name On
          tls On
          tls.verify Off
          tls.vhost opensearch.observability.openchoreo.localhost

k3d:
  dnsRewrite:
    enabled: true

gateway:
  httpPort: 19080
  httpsPort: 19443

kube-prometheus-stack:
  enabled: true
  prometheus:
    prometheusSpec:
      remoteWrite:
      - url: "http://host.k3d.internal:11084/api/v1/write"

observability:
  observabilityPlaneUrl: "http://host.k3d.internal:11086"
