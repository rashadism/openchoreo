{{/* Run validation before creating resources */}}
{{- include "openchoreo-observer-rca.validateLLMConfig" . -}}

apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "openchoreo-observer-rca.fullname" . }}-llm-config
  namespace: {{ .Release.Namespace }}
  labels:
    {{- include "openchoreo-observer-rca.labels" . | nindent 4 }}
data:
  RCA_LLM_PROVIDER: {{ .Values.rcaService.llm.provider | quote }}
  RCA_MODEL_NAME: {{ .Values.rcaService.llm.modelName | quote }}
  {{- if eq .Values.rcaService.llm.provider "azureopenai" }}
  RCA_AZURE_ENDPOINT: {{ .Values.rcaService.llm.azure.endpoint | quote }}
  RCA_AZURE_API_VERSION: {{ .Values.rcaService.llm.azure.apiVersion | quote }}
  RCA_AZURE_DEPLOYMENT: {{ .Values.rcaService.llm.azure.deployment | quote }}
  {{- end }}
