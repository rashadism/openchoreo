# Copyright 2025 The OpenChoreo Authors
# SPDX-License-Identifier: Apache-2.0

openapi: 3.0.3
info:
  title: OpenChoreo API
  version: 1.0.0
  description: |
    REST API for OpenChoreo Internal Developer Platform.

    OpenChoreo provides Kubernetes-native abstractions for developers and platform engineers,
    implementing a multi-plane architecture with control plane and data plane separation.
  contact:
    name: OpenChoreo
    url: https://github.com/openchoreo/openchoreo
  license:
    name: Apache 2.0
    url: https://www.apache.org/licenses/LICENSE-2.0

servers:
  - url: http://localhost:8080
    description: Local development

# Default security - JWT Bearer token required
# Individual endpoints can override with `security: []` for public access
security:
  - bearerAuth: []

tags:
  - name: Operations
    description: Health, readiness, and version endpoints
  - name: Namespaces
    description: Namespace management
  - name: Projects
    description: Project management within namespaces
  - name: Components
    description: Component management within projects
  - name: Environments
    description: Environment management within namespaces
  - name: DataPlanes
    description: DataPlane management for workload deployment targets
  - name: BuildPlanes
    description: BuildPlane management for CI/CD build infrastructure
  - name: ObservabilityPlanes
    description: ObservabilityPlane management for monitoring and logging
  - name: ClusterDataPlanes
    description: Cluster-scoped DataPlane management
  - name: ClusterBuildPlanes
    description: Cluster-scoped BuildPlane management
  - name: ClusterObservabilityPlanes
    description: Cluster-scoped ObservabilityPlane management
  - name: ClusterComponentTypes
    description: Cluster-scoped ComponentType templates defined by platform engineers
  - name: ClusterTraits
    description: Cluster-scoped Trait templates for composable cross-cutting concerns
  - name: ComponentTypes
    description: ComponentType templates defined by platform engineers
  - name: Traits
    description: Trait templates for composable cross-cutting concerns
  - name: Workflows
    description: Generic workflow templates
  - name: ComponentWorkflows
    description: Component-specific workflow templates and runs
  - name: Authorization
    description: Role-based access control and authorization management
  - name: Webhooks
    description: Git provider webhook handlers
  - name: Resources
    description: Generic resource apply and delete operations
  - name: SecretReferences
    description: Secret reference management
  - name: Workloads
    description: Workload source code definitions
  - name: ComponentReleases
    description: Component release management
  - name: Releases
    description: Release management
  - name: ReleaseBindings
    description: Release binding management
  - name: DeploymentPipelines
    description: Deployment pipeline management

paths:
  # =============================================================================
  # Public Endpoints (No Authentication Required)
  # =============================================================================

  /health:
    get:
      operationId: getHealth
      summary: Health check
      description: Returns OK if the server is healthy. Used for liveness probes.
      tags: [Operations]
      security: []
      responses:
        '200':
          description: Server is healthy
          content:
            text/plain:
              schema:
                type: string
                example: OK

  /ready:
    get:
      operationId: getReady
      summary: Readiness check
      description: Returns Ready if the server is ready to accept requests. Used for readiness probes.
      tags: [Operations]
      security: []
      responses:
        '200':
          description: Server is ready
          content:
            text/plain:
              schema:
                type: string
                example: Ready

  /version:
    get:
      operationId: getVersion
      summary: Get server version
      description: Returns version information about the API server.
      tags: [Operations]
      security: []
      responses:
        '200':
          description: Version information
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/VersionResponse'

  /openapi.json:
    get:
      operationId: getOpenAPISpec
      summary: Get OpenAPI specification
      description: Returns the OpenAPI 3.0 specification for this API in JSON format.
      tags: [Operations]
      security: []
      responses:
        '200':
          description: OpenAPI specification
          content:
            application/json:
              schema:
                type: object
                description: OpenAPI 3.0 specification document

  /.well-known/oauth-protected-resource:
    get:
      operationId: getOAuthProtectedResourceMetadata
      summary: Get OAuth protected resource metadata
      description: |
        Returns OAuth 2.0 protected resource metadata as defined in RFC 9728.
        Used by MCP clients to discover authorization server information.
      tags: [Operations]
      security: []
      responses:
        '200':
          description: OAuth protected resource metadata
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OAuthProtectedResourceMetadata'

  /.well-known/openid-configuration:
    get:
      operationId: getOpenIDConfiguration
      summary: Get OpenID configuration
      description: |
        Returns OpenID Connect configuration for CLI authentication.
        Includes OAuth2 endpoints, external client configurations, and security status.
      tags: [Operations]
      security: []
      responses:
        '200':
          description: OpenID configuration
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ClientConfigList'

  # =============================================================================
  # Namespace Endpoints
  # =============================================================================

  /api/v1/namespaces:
    get:
      operationId: listNamespaces
      summary: List namespaces
      description: |
        Returns a paginated list of OpenChoreo control plane namespaces the user has access to.
        Only namespaces with the label `openchoreo.dev/controlplane-namespace=true` are returned.
        This filters out system namespaces (e.g., openchoreo-control-plane, kube-system) and 
        data plane runtime namespaces.
      tags: [Namespaces]
      parameters:
        - $ref: '#/components/parameters/LimitParam'
        - $ref: '#/components/parameters/CursorParam'
      responses:
        '200':
          description: List of namespaces
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NamespaceList'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '500':
          $ref: '#/components/responses/InternalError'

    post:
      operationId: createNamespace
      summary: Create namespace
      description: |
        Creates a new OpenChoreo control plane namespace.
        The namespace is automatically labeled with `openchoreo.dev/controlplane-namespace=true`.
      tags: [Namespaces]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateNamespaceRequest'
      responses:
        '201':
          description: Namespace created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Namespace'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '409':
          description: Namespace already exists
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          $ref: '#/components/responses/InternalError'

  /api/v1/namespaces/{namespaceName}:
    get:
      operationId: getNamespace
      summary: Get namespace
      description: Returns details of a specific namespace.
      tags: [Namespaces]
      parameters:
        - $ref: '#/components/parameters/NamespaceNameParam'
      responses:
        '200':
          description: Namespace details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Namespace'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalError'

  # =============================================================================
  # Project Endpoints
  # =============================================================================

  /api/v1/namespaces/{namespaceName}/projects:
    get:
      operationId: listProjects
      summary: List projects
      description: Returns a paginated list of projects within an namespace.
      tags: [Projects]
      parameters:
        - $ref: '#/components/parameters/NamespaceNameParam'
        - $ref: '#/components/parameters/LimitParam'
        - $ref: '#/components/parameters/CursorParam'
      responses:
        '200':
          description: List of projects
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProjectList'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalError'

    post:
      operationId: createProject
      summary: Create project
      description: Creates a new project within an namespace.
      tags: [Projects]
      parameters:
        - $ref: '#/components/parameters/NamespaceNameParam'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Project'
      responses:
        '201':
          description: Project created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Project'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '409':
          $ref: '#/components/responses/Conflict'
        '500':
          $ref: '#/components/responses/InternalError'

  /api/v1/namespaces/{namespaceName}/projects/{projectName}:
    get:
      operationId: getProject
      summary: Get project
      description: Returns details of a specific project.
      tags: [Projects]
      parameters:
        - $ref: '#/components/parameters/NamespaceNameParam'
        - $ref: '#/components/parameters/ProjectNameParam'
      responses:
        '200':
          description: Project details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Project'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalError'

    put:
      operationId: updateProject
      summary: Update project
      description: Replaces an existing project (full update).
      tags: [Projects]
      parameters:
        - $ref: '#/components/parameters/NamespaceNameParam'
        - $ref: '#/components/parameters/ProjectNameParam'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Project'
      responses:
        '200':
          description: Project updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Project'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '409':
          $ref: '#/components/responses/Conflict'
        '500':
          $ref: '#/components/responses/InternalError'

    delete:
      operationId: deleteProject
      summary: Delete project
      description: Deletes a project by name.
      tags: [Projects]
      parameters:
        - $ref: '#/components/parameters/NamespaceNameParam'
        - $ref: '#/components/parameters/ProjectNameParam'
      responses:
        '204':
          description: Project deleted successfully
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalError'

  # =============================================================================
  # Component Endpoints
  # =============================================================================

  /api/v1/namespaces/{namespaceName}/components:
    get:
      operationId: listComponents
      summary: List components
      description: Returns a paginated list of components within a namespace, optionally filtered by project.
      tags: [Components]
      parameters:
        - $ref: '#/components/parameters/NamespaceNameParam'
        - $ref: '#/components/parameters/ProjectQueryParam'
        - $ref: '#/components/parameters/LimitParam'
        - $ref: '#/components/parameters/CursorParam'
      responses:
        '200':
          description: List of components
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ComponentList'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalError'

    post:
      operationId: createComponent
      summary: Create component
      description: Creates a new component within a namespace.
      tags: [Components]
      parameters:
        - $ref: '#/components/parameters/NamespaceNameParam'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Component'
      responses:
        '201':
          description: Component created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Component'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '409':
          $ref: '#/components/responses/Conflict'
        '500':
          $ref: '#/components/responses/InternalError'

  # =============================================================================
  # Environment Endpoints
  # =============================================================================

  /api/v1/namespaces/{namespaceName}/environments:
    get:
      operationId: listEnvironments
      summary: List environments
      description: Returns a paginated list of environments within an namespace.
      tags: [Environments]
      parameters:
        - $ref: '#/components/parameters/NamespaceNameParam'
        - $ref: '#/components/parameters/LimitParam'
        - $ref: '#/components/parameters/CursorParam'
      responses:
        '200':
          description: List of environments
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/EnvironmentList'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '500':
          $ref: '#/components/responses/InternalError'

    post:
      operationId: createEnvironment
      summary: Create environment
      description: Creates a new environment within an namespace.
      tags: [Environments]
      parameters:
        - $ref: '#/components/parameters/NamespaceNameParam'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Environment'
      responses:
        '201':
          description: Environment created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Environment'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '409':
          $ref: '#/components/responses/Conflict'
        '500':
          $ref: '#/components/responses/InternalError'

  /api/v1/namespaces/{namespaceName}/environments/{envName}:
    get:
      operationId: getEnvironment
      summary: Get environment
      description: Returns details of a specific environment.
      tags: [Environments]
      parameters:
        - $ref: '#/components/parameters/NamespaceNameParam'
        - $ref: '#/components/parameters/EnvironmentNameParam'
      responses:
        '200':
          description: Environment details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Environment'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalError'

  /api/v1/namespaces/{namespaceName}/environments/{envName}/observer-url:
    get:
      operationId: getEnvironmentObserverURL
      summary: Get environment observer URL
      description: Returns the observer URL for accessing logs and metrics for this environment.
      tags: [Environments]
      parameters:
        - $ref: '#/components/parameters/NamespaceNameParam'
        - $ref: '#/components/parameters/EnvironmentNameParam'
      responses:
        '200':
          description: Observer URL information
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ObserverURLResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalError'

  /api/v1/namespaces/{namespaceName}/environments/{envName}/rca-agent-url:
    get:
      operationId: getRCAAgentURL
      summary: Get RCA agent URL
      description: Returns the RCA agent URL for AI-powered root cause analysis for this environment.
      tags: [Environments]
      parameters:
        - $ref: '#/components/parameters/NamespaceNameParam'
        - $ref: '#/components/parameters/EnvironmentNameParam'
      responses:
        '200':
          description: RCA agent URL information
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RCAAgentURLResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalError'

  # =============================================================================
  # DataPlane Endpoints
  # =============================================================================

  /api/v1/namespaces/{namespaceName}/dataplanes:
    get:
      operationId: listDataPlanes
      summary: List data planes
      description: Returns a paginated list of data planes within an namespace.
      tags: [DataPlanes]
      parameters:
        - $ref: '#/components/parameters/NamespaceNameParam'
        - $ref: '#/components/parameters/LimitParam'
        - $ref: '#/components/parameters/CursorParam'
      responses:
        '200':
          description: List of data planes
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DataPlaneList'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '500':
          $ref: '#/components/responses/InternalError'

    post:
      operationId: createDataPlane
      summary: Create data plane
      description: Creates a new data plane within an namespace.
      tags: [DataPlanes]
      parameters:
        - $ref: '#/components/parameters/NamespaceNameParam'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/DataPlane'
      responses:
        '201':
          description: DataPlane created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DataPlane'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '409':
          $ref: '#/components/responses/Conflict'
        '500':
          $ref: '#/components/responses/InternalError'

  /api/v1/namespaces/{namespaceName}/dataplanes/{dpName}:
    get:
      operationId: getDataPlane
      summary: Get data plane
      description: Returns details of a specific data plane.
      tags: [DataPlanes]
      parameters:
        - $ref: '#/components/parameters/NamespaceNameParam'
        - $ref: '#/components/parameters/DataPlaneNameParam'
      responses:
        '200':
          description: DataPlane details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DataPlane'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalError'

  # =============================================================================
  # BuildPlane Endpoints
  # =============================================================================

  /api/v1/namespaces/{namespaceName}/buildplanes:
    get:
      operationId: listBuildPlanes
      summary: List build planes
      description: Returns a paginated list of build planes within a namespace. Typically one per namespace.
      tags: [BuildPlanes]
      parameters:
        - $ref: '#/components/parameters/NamespaceNameParam'
        - $ref: '#/components/parameters/LimitParam'
        - $ref: '#/components/parameters/CursorParam'
      responses:
        '200':
          description: List of build planes
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BuildPlaneList'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '500':
          $ref: '#/components/responses/InternalError'

  /api/v1/namespaces/{namespaceName}/buildplanes/{buildPlaneName}:
    get:
      operationId: getBuildPlane
      summary: Get build plane
      description: Returns details of a specific build plane.
      tags: [BuildPlanes]
      parameters:
        - $ref: '#/components/parameters/NamespaceNameParam'
        - $ref: '#/components/parameters/BuildPlaneNameParam'
      responses:
        '200':
          description: Build plane details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BuildPlane'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalError'

  # =============================================================================
  # ObservabilityPlane Endpoints
  # =============================================================================

  /api/v1/namespaces/{namespaceName}/observabilityplanes:
    get:
      operationId: listObservabilityPlanes
      summary: List observability planes
      description: Returns a paginated list of observability planes within a namespace.
      tags: [ObservabilityPlanes]
      parameters:
        - $ref: '#/components/parameters/NamespaceNameParam'
        - $ref: '#/components/parameters/LimitParam'
        - $ref: '#/components/parameters/CursorParam'
      responses:
        '200':
          description: List of observability planes
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ObservabilityPlaneList'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '500':
          $ref: '#/components/responses/InternalError'

  /api/v1/namespaces/{namespaceName}/observabilityplanes/{observabilityPlaneName}:
    get:
      operationId: getObservabilityPlane
      summary: Get observability plane
      description: Returns details of a specific observability plane.
      tags: [ObservabilityPlanes]
      parameters:
        - $ref: '#/components/parameters/NamespaceNameParam'
        - $ref: '#/components/parameters/ObservabilityPlaneNameParam'
      responses:
        '200':
          description: Observability plane details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ObservabilityPlane'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalError'

  # =============================================================================
  # ClusterDataPlane Endpoints (Cluster-Scoped)
  # =============================================================================

  /api/v1/clusterdataplanes:
    get:
      operationId: listClusterDataPlanes
      summary: List cluster data planes
      description: Returns a paginated list of cluster-scoped data planes.
      tags: [ClusterDataPlanes]
      parameters:
        - $ref: '#/components/parameters/LimitParam'
        - $ref: '#/components/parameters/CursorParam'
      responses:
        '200':
          description: List of cluster data planes
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ClusterDataPlaneList'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '500':
          $ref: '#/components/responses/InternalError'

    post:
      operationId: createClusterDataPlane
      summary: Create cluster data plane
      description: Creates a new cluster-scoped data plane.
      tags: [ClusterDataPlanes]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ClusterDataPlane'
      responses:
        '201':
          description: ClusterDataPlane created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ClusterDataPlane'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '409':
          $ref: '#/components/responses/Conflict'
        '500':
          $ref: '#/components/responses/InternalError'

  /api/v1/clusterdataplanes/{cdpName}:
    get:
      operationId: getClusterDataPlane
      summary: Get cluster data plane
      description: Returns details of a specific cluster-scoped data plane.
      tags: [ClusterDataPlanes]
      parameters:
        - $ref: '#/components/parameters/ClusterDataPlaneNameParam'
      responses:
        '200':
          description: ClusterDataPlane details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ClusterDataPlane'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalError'

  # =============================================================================
  # ClusterBuildPlane Endpoints (Cluster-Scoped)
  # =============================================================================

  /api/v1/clusterbuildplanes:
    get:
      operationId: listClusterBuildPlanes
      summary: List cluster build planes
      description: Returns a list of cluster-scoped build planes.
      tags: [ClusterBuildPlanes]
      parameters:
        - $ref: '#/components/parameters/LimitParam'
        - $ref: '#/components/parameters/CursorParam'
      responses:
        '200':
          description: List of cluster build planes
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ClusterBuildPlaneList'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '500':
          $ref: '#/components/responses/InternalError'

  /api/v1/clusterbuildplanes/{clusterBuildPlaneName}:
    get:
      operationId: getClusterBuildPlane
      summary: Get a cluster build plane
      description: Returns details of a specific cluster-scoped build plane.
      tags: [ClusterBuildPlanes]
      parameters:
        - name: clusterBuildPlaneName
          in: path
          required: true
          schema:
            type: string
          description: Name of the cluster build plane
      responses:
        '200':
          description: Cluster build plane details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ClusterBuildPlane'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalError'

  # =============================================================================
  # ClusterObservabilityPlane Endpoints (Cluster-Scoped)
  # =============================================================================

  /api/v1/clusterobservabilityplanes:
    get:
      operationId: listClusterObservabilityPlanes
      summary: List cluster observability planes
      description: Returns a paginated list of cluster-scoped observability planes.
      tags: [ClusterObservabilityPlanes]
      parameters:
        - $ref: '#/components/parameters/LimitParam'
        - $ref: '#/components/parameters/CursorParam'
      responses:
        '200':
          description: List of cluster observability planes
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ClusterObservabilityPlaneList'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '500':
          $ref: '#/components/responses/InternalError'

  /api/v1/clusterobservabilityplanes/{clusterObservabilityPlaneName}:
    get:
      operationId: getClusterObservabilityPlane
      summary: Get a cluster observability plane
      description: Returns details of a specific cluster-scoped observability plane.
      tags: [ClusterObservabilityPlanes]
      parameters:
        - $ref: '#/components/parameters/ClusterObservabilityPlaneNameParam'
      responses:
        '200':
          description: Cluster observability plane details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ClusterObservabilityPlane'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalError'

  # =============================================================================
  # ClusterComponentType Endpoints (Cluster-Scoped)
  # =============================================================================

  /api/v1/clustercomponenttypes:
    get:
      operationId: listClusterComponentTypes
      summary: List cluster component types
      description: Returns a list of cluster-scoped component types.
      tags: [ClusterComponentTypes]
      responses:
        '200':
          description: List of cluster component types
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ClusterComponentTypeList'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '500':
          $ref: '#/components/responses/InternalError'

  /api/v1/clustercomponenttypes/{cctName}/schema:
    get:
      operationId: getClusterComponentTypeSchema
      summary: Get cluster component type schema
      description: Returns the parameter schema for a specific cluster-scoped component type.
      tags: [ClusterComponentTypes]
      parameters:
        - $ref: '#/components/parameters/ClusterComponentTypeNameParam'
      responses:
        '200':
          description: Cluster component type schema
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SchemaResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalError'

  # =============================================================================
  # ClusterTrait Endpoints (Cluster-Scoped)
  # =============================================================================

  /api/v1/clustertraits:
    get:
      operationId: listClusterTraits
      summary: List cluster traits
      description: Returns a list of cluster-scoped traits.
      tags: [ClusterTraits]
      responses:
        '200':
          description: List of cluster traits
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ClusterTraitList'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '500':
          $ref: '#/components/responses/InternalError'

  /api/v1/clustertraits/{clusterTraitName}/schema:
    get:
      operationId: getClusterTraitSchema
      summary: Get cluster trait schema
      description: Returns the parameter schema for a specific cluster-scoped trait.
      tags: [ClusterTraits]
      parameters:
        - $ref: '#/components/parameters/ClusterTraitNameParam'
      responses:
        '200':
          description: Cluster trait schema
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SchemaResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalError'

  # =============================================================================
  # ComponentType Endpoints
  # =============================================================================

  /api/v1/namespaces/{namespaceName}/componenttypes:
    get:
      operationId: listComponentTypes
      summary: List component types
      description: Returns a paginated list of component types available in the namespace.
      tags: [ComponentTypes]
      parameters:
        - $ref: '#/components/parameters/NamespaceNameParam'
        - $ref: '#/components/parameters/LimitParam'
        - $ref: '#/components/parameters/CursorParam'
      responses:
        '200':
          description: List of component types
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ComponentTypeList'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '500':
          $ref: '#/components/responses/InternalError'

    post:
      operationId: createComponentType
      summary: Create component type
      description: Creates a new component type within a namespace.
      tags: [ComponentTypes]
      parameters:
        - $ref: '#/components/parameters/NamespaceNameParam'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ComponentType'
      responses:
        '201':
          description: Component type created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ComponentType'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '409':
          $ref: '#/components/responses/Conflict'
        '500':
          $ref: '#/components/responses/InternalError'

  /api/v1/namespaces/{namespaceName}/componenttypes/{ctName}:
    get:
      operationId: getComponentType
      summary: Get component type
      description: Returns details of a specific component type.
      tags: [ComponentTypes]
      parameters:
        - $ref: '#/components/parameters/NamespaceNameParam'
        - $ref: '#/components/parameters/ComponentTypeNameParam'
      responses:
        '200':
          description: Component type details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ComponentType'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalError'

    put:
      operationId: updateComponentType
      summary: Update component type
      description: Replaces an existing component type (full update).
      tags: [ComponentTypes]
      parameters:
        - $ref: '#/components/parameters/NamespaceNameParam'
        - $ref: '#/components/parameters/ComponentTypeNameParam'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ComponentType'
      responses:
        '200':
          description: Component type updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ComponentType'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '409':
          $ref: '#/components/responses/Conflict'
        '500':
          $ref: '#/components/responses/InternalError'

    delete:
      operationId: deleteComponentType
      summary: Delete component type
      description: Deletes a component type by name.
      tags: [ComponentTypes]
      parameters:
        - $ref: '#/components/parameters/NamespaceNameParam'
        - $ref: '#/components/parameters/ComponentTypeNameParam'
      responses:
        '204':
          description: Component type deleted successfully
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalError'

  /api/v1/namespaces/{namespaceName}/componenttypes/{ctName}/schema:
    get:
      operationId: getComponentTypeSchema
      summary: Get component type schema
      description: Returns the parameter schema for a specific component type.
      tags: [ComponentTypes]
      parameters:
        - $ref: '#/components/parameters/NamespaceNameParam'
        - $ref: '#/components/parameters/ComponentTypeNameParam'
      responses:
        '200':
          description: Component type schema
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SchemaResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalError'

  # =============================================================================
  # Trait Endpoints
  # =============================================================================

  /api/v1/namespaces/{namespaceName}/traits:
    get:
      operationId: listTraits
      summary: List traits
      description: Returns a paginated list of traits available in the namespace.
      tags: [Traits]
      parameters:
        - $ref: '#/components/parameters/NamespaceNameParam'
        - $ref: '#/components/parameters/LimitParam'
        - $ref: '#/components/parameters/CursorParam'
      responses:
        '200':
          description: List of traits
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TraitList'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '500':
          $ref: '#/components/responses/InternalError'

    post:
      operationId: createTrait
      summary: Create trait
      description: Creates a new trait within a namespace.
      tags: [Traits]
      parameters:
        - $ref: '#/components/parameters/NamespaceNameParam'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Trait'
      responses:
        '201':
          description: Trait created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Trait'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '409':
          $ref: '#/components/responses/Conflict'
        '500':
          $ref: '#/components/responses/InternalError'

  /api/v1/namespaces/{namespaceName}/traits/{traitName}:
    get:
      operationId: getTrait
      summary: Get trait
      description: Returns details of a specific trait.
      tags: [Traits]
      parameters:
        - $ref: '#/components/parameters/NamespaceNameParam'
        - $ref: '#/components/parameters/TraitNameParam'
      responses:
        '200':
          description: Trait details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Trait'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalError'

    put:
      operationId: updateTrait
      summary: Update trait
      description: Replaces an existing trait (full update).
      tags: [Traits]
      parameters:
        - $ref: '#/components/parameters/NamespaceNameParam'
        - $ref: '#/components/parameters/TraitNameParam'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Trait'
      responses:
        '200':
          description: Trait updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Trait'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '409':
          $ref: '#/components/responses/Conflict'
        '500':
          $ref: '#/components/responses/InternalError'

    delete:
      operationId: deleteTrait
      summary: Delete trait
      description: Deletes a trait by name.
      tags: [Traits]
      parameters:
        - $ref: '#/components/parameters/NamespaceNameParam'
        - $ref: '#/components/parameters/TraitNameParam'
      responses:
        '204':
          description: Trait deleted successfully
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalError'

  /api/v1/namespaces/{namespaceName}/traits/{traitName}/schema:
    get:
      operationId: getTraitSchema
      summary: Get trait schema
      description: Returns the parameter schema for a specific trait.
      tags: [Traits]
      parameters:
        - $ref: '#/components/parameters/NamespaceNameParam'
        - $ref: '#/components/parameters/TraitNameParam'
      responses:
        '200':
          description: Trait schema
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SchemaResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalError'

  # =============================================================================
  # Workflow Endpoints (Generic Workflows)
  # =============================================================================

  /api/v1/namespaces/{namespaceName}/workflows:
    get:
      operationId: listWorkflows
      summary: List workflows
      description: Returns a list of generic workflows available in the namespace.
      tags: [Workflows]
      parameters:
        - $ref: '#/components/parameters/NamespaceNameParam'
        - $ref: '#/components/parameters/LimitParam'
        - $ref: '#/components/parameters/CursorParam'
      responses:
        '200':
          description: List of workflows
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/WorkflowList'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '500':
          $ref: '#/components/responses/InternalError'

  /api/v1/namespaces/{namespaceName}/workflows/{workflowName}/schema:
    get:
      operationId: getWorkflowSchema
      summary: Get workflow schema
      description: Returns the parameter schema for a specific workflow.
      tags: [Workflows]
      parameters:
        - $ref: '#/components/parameters/NamespaceNameParam'
        - $ref: '#/components/parameters/WorkflowNameParam'
      responses:
        '200':
          description: Workflow schema
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SchemaResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalError'

  # =============================================================================
  # WorkflowRun Endpoints (Generic Workflow Executions)
  # =============================================================================

  /api/v1/namespaces/{namespaceName}/workflow-runs:
    get:
      operationId: listWorkflowRuns
      summary: List workflow runs
      description: Returns a list of generic workflow runs in the namespace.
      tags: [Workflows]
      parameters:
        - $ref: '#/components/parameters/NamespaceNameParam'
        - $ref: '#/components/parameters/LimitParam'
        - $ref: '#/components/parameters/CursorParam'
      responses:
        '200':
          description: List of workflow runs
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/WorkflowRunList'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '500':
          $ref: '#/components/responses/InternalError'

    post:
      operationId: createWorkflowRun
      summary: Create workflow run
      description: Triggers a new generic workflow run.
      tags: [Workflows]
      parameters:
        - $ref: '#/components/parameters/NamespaceNameParam'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateWorkflowRunRequest'
      responses:
        '201':
          description: Workflow run created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/WorkflowRun'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalError'

  /api/v1/namespaces/{namespaceName}/workflow-runs/{runName}:
    get:
      operationId: getWorkflowRun
      summary: Get workflow run
      description: Returns details of a specific workflow run.
      tags: [Workflows]
      parameters:
        - $ref: '#/components/parameters/NamespaceNameParam'
        - $ref: '#/components/parameters/WorkflowRunNameParam'
      responses:
        '200':
          description: Workflow run details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/WorkflowRun'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalError'

  /api/v1/namespaces/{namespaceName}/workflow-runs/{runName}/status:
    get:
      operationId: getWorkflowRunStatus
      summary: Get workflow run status
      description: Returns the overall status and per-step status of a specific workflow run.
      tags: [Workflows]
      parameters:
        - $ref: '#/components/parameters/NamespaceNameParam'
        - $ref: '#/components/parameters/WorkflowRunNameParam'
      responses:
        '200':
          description: Workflow run status
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/WorkflowRunStatusResponse'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalError'

  /api/v1/namespaces/{namespaceName}/workflow-runs/{runName}/logs:
    get:
      operationId: getWorkflowRunLogs
      summary: Get workflow run logs
      description: Returns logs for a specific workflow run from the build plane. Logs are fetched live from the build plane; no archived logs are returned for completed runs.
      tags: [Workflows]
      parameters:
        - $ref: '#/components/parameters/NamespaceNameParam'
        - $ref: '#/components/parameters/WorkflowRunNameParam'
        - name: step
          in: query
          required: false
          description: Filter logs by step name
          schema:
            type: string
        - name: sinceSeconds
          in: query
          required: false
          description: Return logs newer than a relative duration in seconds
          schema:
            type: integer
            format: int64
            minimum: 0
      responses:
        '200':
          description: Workflow run logs
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/WorkflowRunLogEntry'
        '400':
          $ref: '#/components/responses/BadRequest'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalError'

  /api/v1/namespaces/{namespaceName}/workflow-runs/{runName}/events:
    get:
      operationId: getWorkflowRunEvents
      summary: Get workflow run events
      description: Returns Kubernetes events for a specific workflow run.
      tags: [Workflows]
      parameters:
        - $ref: '#/components/parameters/NamespaceNameParam'
        - $ref: '#/components/parameters/WorkflowRunNameParam'
        - name: step
          in: query
          required: false
          description: Filter events by step name
          schema:
            type: string
      responses:
        '200':
          description: Workflow run events
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/WorkflowRunEventEntry'
        '400':
          $ref: '#/components/responses/BadRequest'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalError'

  # =============================================================================
  # ComponentWorkflow Endpoints
  # =============================================================================

  /api/v1/namespaces/{namespaceName}/component-workflows:
    get:
      operationId: listComponentWorkflows
      summary: List component workflows
      description: Returns a list of component workflow templates available in the namespace.
      tags: [ComponentWorkflows]
      parameters:
        - $ref: '#/components/parameters/NamespaceNameParam'
        - $ref: '#/components/parameters/LimitParam'
        - $ref: '#/components/parameters/CursorParam'
      responses:
        '200':
          description: List of component workflows
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ComponentWorkflowTemplateList'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '500':
          $ref: '#/components/responses/InternalError'

  /api/v1/namespaces/{namespaceName}/component-workflows/{cwName}/schema:
    get:
      operationId: getComponentWorkflowSchema
      summary: Get component workflow schema
      description: Returns the parameter schema for a specific component workflow.
      tags: [ComponentWorkflows]
      parameters:
        - $ref: '#/components/parameters/NamespaceNameParam'
        - $ref: '#/components/parameters/ComponentWorkflowNameParam'
      responses:
        '200':
          description: Component workflow schema
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SchemaResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalError'

  /api/v1/namespaces/{namespaceName}/components/{componentName}:
    get:
      operationId: getComponent
      summary: Get component
      description: Returns details of a specific component.
      tags: [Components]
      parameters:
        - $ref: '#/components/parameters/NamespaceNameParam'
        - $ref: '#/components/parameters/ComponentNameParam'
      responses:
        '200':
          description: Component details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Component'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalError'

    put:
      operationId: updateComponent
      summary: Update component
      description: Replaces an existing component (full update).
      tags: [Components]
      parameters:
        - $ref: '#/components/parameters/NamespaceNameParam'
        - $ref: '#/components/parameters/ComponentNameParam'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Component'
      responses:
        '200':
          description: Component updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Component'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '409':
          $ref: '#/components/responses/Conflict'
        '500':
          $ref: '#/components/responses/InternalError'

    delete:
      operationId: deleteComponent
      summary: Delete component
      description: Deletes a component by name.
      tags: [Components]
      parameters:
        - $ref: '#/components/parameters/NamespaceNameParam'
        - $ref: '#/components/parameters/ComponentNameParam'
      responses:
        '204':
          description: Component deleted successfully
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalError'

  /api/v1/namespaces/{namespaceName}/projects/{projectName}/components/{componentName}/schema:
    get:
      operationId: getComponentSchema
      summary: Get component schema
      description: Returns the combined parameter schema for a component (ComponentType + Traits).
      tags: [Components]
      parameters:
        - $ref: '#/components/parameters/NamespaceNameParam'
        - $ref: '#/components/parameters/ProjectNameParam'
        - $ref: '#/components/parameters/ComponentNameParam'
      responses:
        '200':
          description: Component schema
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SchemaResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalError'

  /api/v1/namespaces/{namespaceName}/projects/{projectName}/components/{componentName}/traits:
    get:
      operationId: listComponentTraits
      summary: List component traits
      description: Returns the traits attached to a component.
      tags: [Components]
      parameters:
        - $ref: '#/components/parameters/NamespaceNameParam'
        - $ref: '#/components/parameters/ProjectNameParam'
        - $ref: '#/components/parameters/ComponentNameParam'
      responses:
        '200':
          description: List of component traits
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ComponentTraitList'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalError'

    put:
      operationId: updateComponentTraits
      summary: Update component traits
      description: Replaces the traits attached to a component.
      tags: [Components]
      parameters:
        - $ref: '#/components/parameters/NamespaceNameParam'
        - $ref: '#/components/parameters/ProjectNameParam'
        - $ref: '#/components/parameters/ComponentNameParam'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateComponentTraitsRequest'
      responses:
        '200':
          description: Component traits updated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ComponentTraitList'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalError'

  /api/v1/namespaces/{namespaceName}/projects/{projectName}/components/{componentName}/bindings:
    get:
      operationId: listComponentBindings
      summary: List component bindings
      description: Returns the deployment bindings for a component.
      tags: [Components]
      parameters:
        - $ref: '#/components/parameters/NamespaceNameParam'
        - $ref: '#/components/parameters/ProjectNameParam'
        - $ref: '#/components/parameters/ComponentNameParam'
        - name: environment
          in: query
          required: false
          description: Filter by environment names
          schema:
            type: array
            items:
              type: string
          style: form
          explode: true
      responses:
        '200':
          description: List of bindings
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BindingList'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalError'

  /api/v1/namespaces/{namespaceName}/projects/{projectName}/components/{componentName}/bindings/{bindingName}:
    patch:
      operationId: updateComponentBinding
      summary: Update component binding
      description: Updates a component's deployment binding.
      tags: [Components]
      parameters:
        - $ref: '#/components/parameters/NamespaceNameParam'
        - $ref: '#/components/parameters/ProjectNameParam'
        - $ref: '#/components/parameters/ComponentNameParam'
        - $ref: '#/components/parameters/BindingNameParam'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateBindingRequest'
      responses:
        '200':
          description: Binding updated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Binding'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalError'

  /api/v1/namespaces/{namespaceName}/projects/{projectName}/components/{componentName}/environments/{environmentName}/release/resources:
    get:
      operationId: getReleaseResourceTree
      summary: Get release resource tree
      description: Returns all live Kubernetes resources deployed by the active release for a component in an environment, including child resources like Pods.
      tags: [Components]
      parameters:
        - $ref: '#/components/parameters/NamespaceNameParam'
        - $ref: '#/components/parameters/ProjectNameParam'
        - $ref: '#/components/parameters/ComponentNameParam'
        - $ref: '#/components/parameters/ComponentEnvironmentNameParam'
      responses:
        '200':
          description: Resource tree for the active release
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ResourceTreeResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalError'

  /api/v1/namespaces/{namespaceName}/components/{componentName}/deploy:
    post:
      operationId: deployRelease
      summary: Deploy release
      description: Deploys a component release to an environment.
      tags: [Components]
      parameters:
        - $ref: '#/components/parameters/NamespaceNameParam'
        - $ref: '#/components/parameters/ComponentNameParam'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/DeployReleaseRequest'
      responses:
        '201':
          description: Release deployed
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ReleaseBinding'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalError'

  /api/v1/namespaces/{namespaceName}/components/{componentName}/promote:
    post:
      operationId: promoteComponent
      summary: Promote component
      description: Promotes a component release from one environment to another.
      tags: [Components]
      parameters:
        - $ref: '#/components/parameters/NamespaceNameParam'
        - $ref: '#/components/parameters/ComponentNameParam'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PromoteComponentRequest'
      responses:
        '200':
          description: Component promoted
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ReleaseBinding'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalError'

  /api/v1/namespaces/{namespaceName}/components/{componentName}/generate-release:
    post:
      operationId: generateRelease
      summary: Generate component release
      description: Generates an immutable release snapshot from the current component state (ComponentType, Traits, Workload).
      tags: [Components]
      parameters:
        - $ref: '#/components/parameters/NamespaceNameParam'
        - $ref: '#/components/parameters/ComponentNameParam'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/GenerateReleaseRequest'
      responses:
        '201':
          description: Component release created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ComponentRelease'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalError'

  /api/v1/namespaces/{namespaceName}/projects/{projectName}/components/{componentName}/environments/{environmentName}/observer-url:
    get:
      operationId: getComponentObserverURL
      summary: Get component observer URL
      description: Returns the observer URL for component logs and metrics in an environment.
      tags: [Components]
      parameters:
        - $ref: '#/components/parameters/NamespaceNameParam'
        - $ref: '#/components/parameters/ProjectNameParam'
        - $ref: '#/components/parameters/ComponentNameParam'
        - $ref: '#/components/parameters/ComponentEnvironmentNameParam'
      responses:
        '200':
          description: Observer URL
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ObserverURLResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalError'

  /api/v1/namespaces/{namespaceName}/projects/{projectName}/components/{componentName}/observer-url:
    get:
      operationId: getBuildObserverURL
      summary: Get build observer URL
      description: Returns the observer URL for component build logs.
      tags: [Components]
      parameters:
        - $ref: '#/components/parameters/NamespaceNameParam'
        - $ref: '#/components/parameters/ProjectNameParam'
        - $ref: '#/components/parameters/ComponentNameParam'
      responses:
        '200':
          description: Observer URL
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ObserverURLResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalError'

  /api/v1/namespaces/{namespaceName}/projects/{projectName}/components/{componentName}/workflow-parameters:
    patch:
      operationId: updateComponentWorkflowParameters
      summary: Update component workflow parameters
      description: Updates the workflow parameters for a component.
      tags: [ComponentWorkflows]
      parameters:
        - $ref: '#/components/parameters/NamespaceNameParam'
        - $ref: '#/components/parameters/ProjectNameParam'
        - $ref: '#/components/parameters/ComponentNameParam'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateComponentWorkflowRequest'
      responses:
        '200':
          description: Workflow parameters updated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Component'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalError'

  /api/v1/namespaces/{namespaceName}/projects/{projectName}/components/{componentName}/workflow-runs:
    get:
      operationId: listComponentWorkflowRuns
      summary: List component workflow runs
      description: Returns a list of workflow runs for a component.
      tags: [ComponentWorkflows]
      parameters:
        - $ref: '#/components/parameters/NamespaceNameParam'
        - $ref: '#/components/parameters/ProjectNameParam'
        - $ref: '#/components/parameters/ComponentNameParam'
        - $ref: '#/components/parameters/LimitParam'
        - $ref: '#/components/parameters/CursorParam'
      responses:
        '200':
          description: List of workflow runs
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ComponentWorkflowRunList'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalError'

    post:
      operationId: createComponentWorkflowRun
      summary: Trigger component workflow run
      description: Triggers a new workflow run (build) for a component.
      tags: [ComponentWorkflows]
      parameters:
        - $ref: '#/components/parameters/NamespaceNameParam'
        - $ref: '#/components/parameters/ProjectNameParam'
        - $ref: '#/components/parameters/ComponentNameParam'
        - name: commit
          in: query
          required: false
          description: Specific git commit SHA to build (optional)
          schema:
            type: string
            example: abc1234
      responses:
        '201':
          description: Workflow run triggered
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ComponentWorkflowRun'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalError'

  /api/v1/namespaces/{namespaceName}/projects/{projectName}/components/{componentName}/workflow-runs/{runName}:
    get:
      operationId: getComponentWorkflowRun
      summary: Get component workflow run
      description: Returns details of a specific workflow run.
      tags: [ComponentWorkflows]
      parameters:
        - $ref: '#/components/parameters/NamespaceNameParam'
        - $ref: '#/components/parameters/ProjectNameParam'
        - $ref: '#/components/parameters/ComponentNameParam'
        - $ref: '#/components/parameters/WorkflowRunNameParam'
      responses:
        '200':
          description: Workflow run details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ComponentWorkflowRun'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalError'

  # =============================================================================
  # Authorization Endpoints
  # =============================================================================
  /api/v1/authz/actions:
    get:
      operationId: listActions
      summary: List actions
      description: Returns all defined authorization actions.
      tags: [Authorization]
      responses:
        '200':
          description: List of actions
          content:
            application/json:
              schema:
                type: array
                items:
                  type: string
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '500':
          $ref: '#/components/responses/InternalError'

  /api/v1/authz/evaluate:
    post:
      operationId: evaluate
      summary: Evaluate authorization
      description: Evaluates a single authorization request.
      tags: [Authorization]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/EvaluateRequest'
      responses:
        '200':
          description: Authorization decision
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Decision'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalError'

  /api/v1/authz/batch-evaluate:
    post:
      operationId: batchEvaluate
      summary: Batch evaluate authorization
      description: Evaluates multiple authorization requests in a single call.
      tags: [Authorization]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/BatchEvaluateRequest'
      responses:
        '200':
          description: Authorization decisions
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BatchEvaluateResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalError'

  /api/v1/authz/profile:
    get:
      operationId: getSubjectProfile
      summary: Get subject profile
      description: Returns the authorization profile for the authenticated subject.
      tags: [Authorization]
      parameters:
        - name: namespace
          in: query
          required: false
          description: Namespace scope
          schema:
            type: string
        - name: project
          in: query
          required: false
          description: Project scope
          schema:
            type: string
        - name: component
          in: query
          required: false
          description: Component scope
          schema:
            type: string
      responses:
        '200':
          description: Subject profile
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserCapabilitiesResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '500':
          $ref: '#/components/responses/InternalError'

  /api/v1/clusterroles:
    get:
      operationId: listClusterRoles
      summary: List cluster roles
      description: Returns all cluster-scoped authorization roles.
      tags: [Authorization]
      responses:
        '200':
          description: List of cluster roles
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthzClusterRoleList'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '500':
          $ref: '#/components/responses/InternalError'

    post:
      operationId: createClusterRole
      summary: Create cluster role
      description: Creates a new cluster-scoped authorization role.
      tags: [Authorization]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AuthzClusterRole'
      responses:
        '201':
          description: Cluster role created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthzClusterRole'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '409':
          $ref: '#/components/responses/Conflict'
        '500':
          $ref: '#/components/responses/InternalError'

  /api/v1/clusterroles/{name}:
    get:
      operationId: getClusterRole
      summary: Get cluster role
      description: Returns details of a specific cluster role.
      tags: [Authorization]
      parameters:
        - name: name
          in: path
          required: true
          description: Cluster role name
          schema:
            type: string
            example: cluster-admin
      responses:
        '200':
          description: Cluster role details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthzClusterRole'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalError'

    put:
      operationId: updateClusterRole
      summary: Update cluster role
      description: Updates an existing cluster role's actions and description.
      tags: [Authorization]
      parameters:
        - name: name
          in: path
          required: true
          description: Cluster role name
          schema:
            type: string
            example: cluster-admin
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AuthzClusterRole'
      responses:
        '200':
          description: Cluster role updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthzClusterRole'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalError'

    delete:
      operationId: deleteClusterRole
      summary: Delete cluster role
      description: Deletes a cluster role.
      tags: [Authorization]
      parameters:
        - name: name
          in: path
          required: true
          description: Cluster role name
          schema:
            type: string
            example: cluster-admin
      responses:
        '204':
          description: Cluster role deleted successfully
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '409':
          $ref: '#/components/responses/Conflict'
        '500':
          $ref: '#/components/responses/InternalError'

  /api/v1/clusterrolebindings:
    get:
      operationId: listClusterRoleBindings
      summary: List cluster role bindings
      description: Returns all cluster-scoped role bindings.
      tags: [Authorization]
      responses:
        '200':
          description: List of cluster role bindings
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthzClusterRoleBindingList'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '500':
          $ref: '#/components/responses/InternalError'

    post:
      operationId: createClusterRoleBinding
      summary: Create cluster role binding
      description: Creates a new cluster-scoped role binding.
      tags: [Authorization]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AuthzClusterRoleBinding'
      responses:
        '201':
          description: Cluster role binding created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthzClusterRoleBinding'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '409':
          $ref: '#/components/responses/Conflict'
        '500':
          $ref: '#/components/responses/InternalError'

  /api/v1/clusterrolebindings/{name}:
    get:
      operationId: getClusterRoleBinding
      summary: Get cluster role binding
      description: Returns details of a specific cluster role binding.
      tags: [Authorization]
      parameters:
        - name: name
          in: path
          required: true
          description: Cluster role binding name
          schema:
            type: string
            example: admin-binding
      responses:
        '200':
          description: Cluster role binding details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthzClusterRoleBinding'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalError'

    put:
      operationId: updateClusterRoleBinding
      summary: Update cluster role binding
      description: Updates an existing cluster role binding.
      tags: [Authorization]
      parameters:
        - name: name
          in: path
          required: true
          description: Cluster role binding name
          schema:
            type: string
            example: admin-binding
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AuthzClusterRoleBinding'
      responses:
        '200':
          description: Cluster role binding updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthzClusterRoleBinding'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '409':
          $ref: '#/components/responses/Conflict'
        '500':
          $ref: '#/components/responses/InternalError'

    delete:
      operationId: deleteClusterRoleBinding
      summary: Delete cluster role binding
      description: Deletes a cluster role binding.
      tags: [Authorization]
      parameters:
        - name: name
          in: path
          required: true
          description: Cluster role binding name
          schema:
            type: string
            example: admin-binding
      responses:
        '204':
          description: Cluster role binding deleted successfully
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalError'

  /api/v1/namespaces/{namespaceName}/roles:
    get:
      operationId: listNamespaceRoles
      summary: List namespace roles
      description: Returns all namespace-scoped authorization roles.
      tags: [Authorization]
      parameters:
        - $ref: '#/components/parameters/NamespaceNameParam'
      responses:
        '200':
          description: List of namespace roles
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthzRoleList'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '500':
          $ref: '#/components/responses/InternalError'

    post:
      operationId: createNamespaceRole
      summary: Create namespace role
      description: Creates a new namespace-scoped authorization role.
      tags: [Authorization]
      parameters:
        - $ref: '#/components/parameters/NamespaceNameParam'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AuthzRole'
      responses:
        '201':
          description: Namespace role created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthzRole'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '409':
          $ref: '#/components/responses/Conflict'
        '500':
          $ref: '#/components/responses/InternalError'

  /api/v1/namespaces/{namespaceName}/roles/{name}:
    get:
      operationId: getNamespaceRole
      summary: Get namespace role
      description: Returns details of a specific namespace role.
      tags: [Authorization]
      parameters:
        - $ref: '#/components/parameters/NamespaceNameParam'
        - name: name
          in: path
          required: true
          description: Namespace role name
          schema:
            type: string
            example: developer
      responses:
        '200':
          description: Namespace role details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthzRole'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalError'

    put:
      operationId: updateNamespaceRole
      summary: Update namespace role
      description: Updates an existing namespace role's actions and description.
      tags: [Authorization]
      parameters:
        - $ref: '#/components/parameters/NamespaceNameParam'
        - name: name
          in: path
          required: true
          description: Namespace role name
          schema:
            type: string
            example: developer
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AuthzRole'
      responses:
        '200':
          description: Namespace role updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthzRole'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalError'

    delete:
      operationId: deleteNamespaceRole
      summary: Delete namespace role
      description: Deletes a namespace role.
      tags: [Authorization]
      parameters:
        - $ref: '#/components/parameters/NamespaceNameParam'
        - name: name
          in: path
          required: true
          description: Namespace role name
          schema:
            type: string
            example: developer
      responses:
        '204':
          description: Namespace role deleted successfully
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '409':
          $ref: '#/components/responses/Conflict'
        '500':
          $ref: '#/components/responses/InternalError'

  /api/v1/namespaces/{namespaceName}/rolebindings:
    get:
      operationId: listNamespaceRoleBindings
      summary: List namespace role bindings
      description: Returns all namespace-scoped role bindings.
      tags: [Authorization]
      parameters:
        - $ref: '#/components/parameters/NamespaceNameParam'
      responses:
        '200':
          description: List of namespace role bindings
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthzRoleBindingList'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '500':
          $ref: '#/components/responses/InternalError'

    post:
      operationId: createNamespaceRoleBinding
      summary: Create namespace role binding
      description: Creates a new namespace-scoped role binding.
      tags: [Authorization]
      parameters:
        - $ref: '#/components/parameters/NamespaceNameParam'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AuthzRoleBinding'
      responses:
        '201':
          description: Namespace role binding created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthzRoleBinding'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '409':
          $ref: '#/components/responses/Conflict'
        '500':
          $ref: '#/components/responses/InternalError'

  /api/v1/namespaces/{namespaceName}/rolebindings/{name}:
    get:
      operationId: getNamespaceRoleBinding
      summary: Get namespace role binding
      description: Returns details of a specific namespace role binding.
      tags: [Authorization]
      parameters:
        - $ref: '#/components/parameters/NamespaceNameParam'
        - name: name
          in: path
          required: true
          description: Namespace role binding name
          schema:
            type: string
            example: developer-binding
      responses:
        '200':
          description: Namespace role binding details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthzRoleBinding'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalError'

    put:
      operationId: updateNamespaceRoleBinding
      summary: Update namespace role binding
      description: Updates an existing namespace role binding.
      tags: [Authorization]
      parameters:
        - $ref: '#/components/parameters/NamespaceNameParam'
        - name: name
          in: path
          required: true
          description: Namespace role binding name
          schema:
            type: string
            example: developer-binding
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AuthzRoleBinding'
      responses:
        '200':
          description: Namespace role binding updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthzRoleBinding'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '409':
          $ref: '#/components/responses/Conflict'
        '500':
          $ref: '#/components/responses/InternalError'

    delete:
      operationId: deleteNamespaceRoleBinding
      summary: Delete namespace role binding
      description: Deletes a namespace role binding.
      tags: [Authorization]
      parameters:
        - $ref: '#/components/parameters/NamespaceNameParam'
        - name: name
          in: path
          required: true
          description: Namespace role binding name
          schema:
            type: string
            example: developer-binding
      responses:
        '204':
          description: Namespace role binding deleted successfully
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalError'

  # =============================================================================
  # User Types Endpoint
  # =============================================================================

  /api/v1/user-types:
    get:
      operationId: listUserTypes
      summary: List user types
      description: Returns the configured user types for authentication and authorization.
      tags: [Authorization]
      responses:
        '200':
          description: List of configured user types
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UserTypeConfig'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalError'

  # =============================================================================
  # Webhook Endpoints
  # =============================================================================

  /api/v1/webhooks/github:
    post:
      operationId: handleGitHubWebhook
      summary: Handle GitHub webhook
      description: Processes incoming GitHub webhook events to trigger builds.
      tags: [Webhooks]
      security: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              description: GitHub webhook payload
              additionalProperties: true
      responses:
        '200':
          description: Webhook processed successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/WebhookEventResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalError'

  /api/v1/webhooks/gitlab:
    post:
      operationId: handleGitLabWebhook
      summary: Handle GitLab webhook
      description: Processes incoming GitLab webhook events to trigger builds.
      tags: [Webhooks]
      security: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              description: GitLab webhook payload
              additionalProperties: true
      responses:
        '200':
          description: Webhook processed successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/WebhookEventResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalError'

  /api/v1/webhooks/bitbucket:
    post:
      operationId: handleBitbucketWebhook
      summary: Handle Bitbucket webhook
      description: Processes incoming Bitbucket webhook events to trigger builds.
      tags: [Webhooks]
      security: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              description: Bitbucket webhook payload
              additionalProperties: true
      responses:
        '200':
          description: Webhook processed successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/WebhookEventResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalError'

  # =============================================================================
  # Resource Apply/Delete Endpoints
  # =============================================================================

  /api/v1/apply:
    post:
      operationId: applyResource
      summary: Apply resource
      description: Applies a Kubernetes resource (like kubectl apply). Creates or updates the resource.
      tags: [Resources]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/KubernetesResource'
      responses:
        '200':
          description: Resource applied successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApplyResourceResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '500':
          $ref: '#/components/responses/InternalError'

  /api/v1/delete:
    delete:
      operationId: deleteResource
      summary: Delete resource
      description: Deletes a Kubernetes resource (like kubectl delete).
      tags: [Resources]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/KubernetesResource'
      responses:
        '200':
          description: Resource deleted successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DeleteResourceResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '500':
          $ref: '#/components/responses/InternalError'

  # =============================================================================
  # Secret Reference Endpoints
  # =============================================================================

  /api/v1/namespaces/{namespaceName}/secret-references:
    get:
      operationId: listSecretReferences
      summary: List secret references
      description: Returns a list of secret references within an namespace.
      tags: [SecretReferences]
      parameters:
        - $ref: '#/components/parameters/NamespaceNameParam'
      responses:
        '200':
          description: List of secret references
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SecretReferenceList'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalError'

  # =============================================================================
  # Workload Endpoints
  # =============================================================================

  /api/v1/namespaces/{namespaceName}/workloads:
    get:
      operationId: listWorkloads
      summary: List workloads
      description: Returns a paginated list of workloads within a namespace, optionally filtered by component.
      tags: [Workloads]
      parameters:
        - $ref: '#/components/parameters/NamespaceNameParam'
        - $ref: '#/components/parameters/ComponentQueryParam'
        - $ref: '#/components/parameters/LimitParam'
        - $ref: '#/components/parameters/CursorParam'
      responses:
        '200':
          description: List of workloads
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/WorkloadList'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalError'

    post:
      operationId: createWorkload
      summary: Create workload
      description: Creates a new workload within a namespace.
      tags: [Workloads]
      parameters:
        - $ref: '#/components/parameters/NamespaceNameParam'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Workload'
      responses:
        '201':
          description: Workload created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Workload'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '409':
          $ref: '#/components/responses/Conflict'
        '500':
          $ref: '#/components/responses/InternalError'

  /api/v1/namespaces/{namespaceName}/workloads/{workloadName}:
    get:
      operationId: getWorkload
      summary: Get workload
      description: Returns details of a specific workload.
      tags: [Workloads]
      parameters:
        - $ref: '#/components/parameters/NamespaceNameParam'
        - $ref: '#/components/parameters/WorkloadNameParam'
      responses:
        '200':
          description: Workload details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Workload'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalError'

    put:
      operationId: updateWorkload
      summary: Update workload
      description: Replaces an existing workload (full update).
      tags: [Workloads]
      parameters:
        - $ref: '#/components/parameters/NamespaceNameParam'
        - $ref: '#/components/parameters/WorkloadNameParam'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Workload'
      responses:
        '200':
          description: Workload updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Workload'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalError'

    delete:
      operationId: deleteWorkload
      summary: Delete workload
      description: Deletes a workload by name.
      tags: [Workloads]
      parameters:
        - $ref: '#/components/parameters/NamespaceNameParam'
        - $ref: '#/components/parameters/WorkloadNameParam'
      responses:
        '204':
          description: Workload deleted successfully
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalError'

  # =============================================================================
  # Component Release Endpoints
  # =============================================================================

  /api/v1/namespaces/{namespaceName}/componentreleases:
    get:
      operationId: listComponentReleases
      summary: List component releases
      description: Returns a paginated list of component releases within a namespace, optionally filtered by component.
      tags: [ComponentReleases]
      parameters:
        - $ref: '#/components/parameters/NamespaceNameParam'
        - $ref: '#/components/parameters/ComponentQueryParam'
        - $ref: '#/components/parameters/LimitParam'
        - $ref: '#/components/parameters/CursorParam'
      responses:
        '200':
          description: List of component releases
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ComponentReleaseList'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalError'

  /api/v1/namespaces/{namespaceName}/componentreleases/{componentReleaseName}:
    get:
      operationId: getComponentRelease
      summary: Get component release
      description: Returns details of a specific component release.
      tags: [ComponentReleases]
      parameters:
        - $ref: '#/components/parameters/NamespaceNameParam'
        - $ref: '#/components/parameters/ComponentReleaseNameParam'
      responses:
        '200':
          description: Component release details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ComponentRelease'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalError'

  # =============================================================================
  # Release Endpoints
  # =============================================================================

  /api/v1/namespaces/{namespaceName}/releases:
    get:
      operationId: listReleases
      summary: List releases
      description: Returns a paginated list of releases within a namespace, optionally filtered by component and environment.
      tags: [Releases]
      parameters:
        - $ref: '#/components/parameters/NamespaceNameParam'
        - $ref: '#/components/parameters/ComponentQueryParam'
        - $ref: '#/components/parameters/EnvironmentQueryParam'
        - $ref: '#/components/parameters/LimitParam'
        - $ref: '#/components/parameters/CursorParam'
      responses:
        '200':
          description: List of releases
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ReleaseList'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalError'

  /api/v1/namespaces/{namespaceName}/releases/{releaseName}:
    get:
      operationId: getRelease
      summary: Get release
      description: Returns details of a specific release.
      tags: [Releases]
      parameters:
        - $ref: '#/components/parameters/NamespaceNameParam'
        - $ref: '#/components/parameters/ReleaseNameParam'
      responses:
        '200':
          description: Release details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Release'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalError'

  # =============================================================================
  # Release Binding Endpoints
  # =============================================================================

  /api/v1/namespaces/{namespaceName}/releasebindings:
    get:
      operationId: listReleaseBindings
      summary: List release bindings
      description: Returns a paginated list of release bindings within a namespace, optionally filtered by component.
      tags: [ReleaseBindings]
      parameters:
        - $ref: '#/components/parameters/NamespaceNameParam'
        - $ref: '#/components/parameters/ComponentQueryParam'
        - $ref: '#/components/parameters/LimitParam'
        - $ref: '#/components/parameters/CursorParam'
      responses:
        '200':
          description: List of release bindings
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ReleaseBindingList'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalError'

    post:
      operationId: createReleaseBinding
      summary: Create release binding
      description: Creates a new release binding within a namespace.
      tags: [ReleaseBindings]
      parameters:
        - $ref: '#/components/parameters/NamespaceNameParam'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ReleaseBinding'
      responses:
        '201':
          description: Release binding created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ReleaseBinding'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '409':
          $ref: '#/components/responses/Conflict'
        '500':
          $ref: '#/components/responses/InternalError'

  /api/v1/namespaces/{namespaceName}/releasebindings/{releaseBindingName}:
    get:
      operationId: getReleaseBinding
      summary: Get release binding
      description: Returns details of a specific release binding.
      tags: [ReleaseBindings]
      parameters:
        - $ref: '#/components/parameters/NamespaceNameParam'
        - $ref: '#/components/parameters/ReleaseBindingNameParam'
      responses:
        '200':
          description: Release binding details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ReleaseBinding'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalError'

    put:
      operationId: updateReleaseBinding
      summary: Update release binding
      description: Replaces an existing release binding (full update).
      tags: [ReleaseBindings]
      parameters:
        - $ref: '#/components/parameters/NamespaceNameParam'
        - $ref: '#/components/parameters/ReleaseBindingNameParam'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ReleaseBinding'
      responses:
        '200':
          description: Release binding updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ReleaseBinding'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalError'

    delete:
      operationId: deleteReleaseBinding
      summary: Delete release binding
      description: Deletes a release binding by name.
      tags: [ReleaseBindings]
      parameters:
        - $ref: '#/components/parameters/NamespaceNameParam'
        - $ref: '#/components/parameters/ReleaseBindingNameParam'
      responses:
        '204':
          description: Release binding deleted successfully
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalError'

  # =============================================================================
  # Deployment Pipeline Endpoints
  # =============================================================================

  /api/v1/namespaces/{namespaceName}/projects/{projectName}/deployment-pipeline:
    get:
      operationId: getProjectDeploymentPipeline
      summary: Get project deployment pipeline
      description: Returns the deployment pipeline for a project.
      tags: [DeploymentPipelines]
      parameters:
        - $ref: '#/components/parameters/NamespaceNameParam'
        - $ref: '#/components/parameters/ProjectNameParam'
      responses:
        '200':
          description: Deployment pipeline details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DeploymentPipeline'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalError'

components:
  # ===========================================================================
  # Security Schemes
  # ===========================================================================
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
      description: |
        JWT Bearer token authentication.

        Obtain a token from your identity provider and include it in the
        Authorization header: `Authorization: Bearer <token>`

        The server validates tokens using JWKS from the configured issuer.

  # ===========================================================================
  # Common Parameters
  # ===========================================================================
  parameters:
    NamespaceNameParam:
      name: namespaceName
      in: path
      required: true
      description: Namespace name
      schema:
        type: string
        example: my-namespace

    ProjectNameParam:
      name: projectName
      in: path
      required: true
      description: Project name
      schema:
        type: string
        example: my-project

    BuildPlaneNameParam:
      name: buildPlaneName
      in: path
      required: true
      description: Build plane name
      schema:
        type: string
        example: default-buildplane

    ProjectQueryParam:
      name: project
      in: query
      required: false
      description: Filter resources by project name
      schema:
        type: string
        example: my-project

    ComponentQueryParam:
      name: component
      in: query
      required: false
      description: Filter resources by component name
      schema:
        type: string
        example: api-service

    EnvironmentQueryParam:
      name: environment
      in: query
      required: false
      description: Filter resources by environment name
      schema:
        type: string
        example: dev

    WorkloadNameParam:
      name: workloadName
      in: path
      required: true
      description: Workload name
      schema:
        type: string
        example: api-service-workload

    EnvironmentNameParam:
      name: envName
      in: path
      required: true
      description: Environment name
      schema:
        type: string
        example: dev

    ComponentEnvironmentNameParam:
      name: environmentName
      in: path
      required: true
      description: Environment name for component-scoped operations
      schema:
        type: string
        example: dev

    DataPlaneNameParam:
      name: dpName
      in: path
      required: true
      description: DataPlane name
      schema:
        type: string
        example: default-dataplane

    ClusterDataPlaneNameParam:
      name: cdpName
      in: path
      required: true
      description: ClusterDataPlane name
      schema:
        type: string
        example: shared-dataplane

    ObservabilityPlaneNameParam:
      name: observabilityPlaneName
      in: path
      required: true
      description: ObservabilityPlane name
      schema:
        type: string
        example: default-observability

    ClusterObservabilityPlaneNameParam:
      name: clusterObservabilityPlaneName
      in: path
      required: true
      description: ClusterObservabilityPlane name
      schema:
        type: string
        example: shared-observability

    ComponentTypeNameParam:
      name: ctName
      in: path
      required: true
      description: ComponentType name
      schema:
        type: string
        example: go-service

    ClusterComponentTypeNameParam:
      name: cctName
      in: path
      required: true
      description: ClusterComponentType name
      schema:
        type: string
        example: go-service

    ClusterTraitNameParam:
      name: clusterTraitName
      in: path
      required: true
      description: ClusterTrait name
      schema:
        type: string
        example: autoscaler

    TraitNameParam:
      name: traitName
      in: path
      required: true
      description: Trait name
      schema:
        type: string
        example: autoscaler

    WorkflowNameParam:
      name: workflowName
      in: path
      required: true
      description: Workflow name
      schema:
        type: string
        example: database-migration

    ComponentWorkflowNameParam:
      name: cwName
      in: path
      required: true
      description: ComponentWorkflow name
      schema:
        type: string
        example: docker-build

    ComponentNameParam:
      name: componentName
      in: path
      required: true
      description: Component name
      schema:
        type: string
        example: api-service

    WorkflowRunNameParam:
      name: runName
      in: path
      required: true
      description: Workflow run name
      schema:
        type: string
        example: api-service-run-1234

    BindingNameParam:
      name: bindingName
      in: path
      required: true
      description: Binding name
      schema:
        type: string
        example: api-service-dev

    ReleaseBindingNameParam:
      name: releaseBindingName
      in: path
      required: true
      description: Release binding name
      schema:
        type: string
        example: api-service-dev

    ComponentReleaseNameParam:
      name: componentReleaseName
      in: path
      required: true
      description: Component release name
      schema:
        type: string
        example: api-service-v1.0.0

    ReleaseNameParam:
      name: releaseName
      in: path
      required: true
      description: Release name
      schema:
        type: string
        example: v1.0.0

    RoleNameParam:
      name: roleName
      in: path
      required: true
      description: Role name
      schema:
        type: string
        example: admin

    MappingIdParam:
      name: mappingId
      in: path
      required: true
      description: Role mapping ID
      schema:
        type: integer
        format: int64
        example: 123

    LimitParam:
      name: limit
      in: query
      required: false
      description: Maximum number of items to return per page
      schema:
        type: integer
        minimum: 1
        maximum: 100
        default: 20

    CursorParam:
      name: cursor
      in: query
      required: false
      description: |
        Opaque pagination cursor from a previous response.
        Pass the `nextCursor` value from pagination metadata to fetch the next page.
      schema:
        type: string

  # ===========================================================================
  # Common Responses
  # ===========================================================================
  responses:
    BadRequest:
      description: Invalid request parameters
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
          example:
            error: "Invalid request: name is required"
            code: BAD_REQUEST
            details:
              - field: name
                message: is required

    Unauthorized:
      description: Authentication required or token invalid
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
          example:
            error: "Authentication required"
            code: UNAUTHORIZED

    Forbidden:
      description: Insufficient permissions to access the resource
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
          example:
            error: "You do not have permission to access this resource"
            code: FORBIDDEN

    NotFound:
      description: Resource not found
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
          example:
            error: "Project 'my-project' not found"
            code: NOT_FOUND

    Conflict:
      description: Resource already exists
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
          example:
            error: "Project 'my-project' already exists"
            code: CONFLICT

    InternalError:
      description: Internal server error
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
          example:
            error: "Internal server error"
            code: INTERNAL_ERROR

  # ===========================================================================
  # Schemas
  # ===========================================================================
  schemas:
    # -------------------------------------------------------------------------
    # Error Response
    # -------------------------------------------------------------------------
    ErrorResponse:
      type: object
      description: Standard error response format
      required:
        - error
        - code
      properties:
        error:
          type: string
          description: Human-readable error message
          example: "Project 'my-project' not found"
        code:
          type: string
          description: Machine-readable error code
          enum:
            - BAD_REQUEST
            - UNAUTHORIZED
            - FORBIDDEN
            - NOT_FOUND
            - CONFLICT
            - INTERNAL_ERROR
          example: NOT_FOUND
        details:
          type: array
          description: Additional error details (e.g., validation errors)
          items:
            type: object
            properties:
              field:
                type: string
                description: Field that caused the error
                example: name
              message:
                type: string
                description: Error message for this field
                example: must be at least 1 character

    # -------------------------------------------------------------------------
    # Shared Kubernetes-style Types
    # -------------------------------------------------------------------------
    ObjectMeta:
      type: object
      description: |
        Standard Kubernetes object metadata (without kind/apiVersion).
        Matches the structure of metav1.ObjectMeta for the fields exposed via the API.
      required:
        - name
      properties:
        name:
          type: string
          description: Name of the resource (unique within namespace)
          example: my-project
        namespace:
          type: string
          description: Kubernetes namespace
          example: my-namespace
        uid:
          type: string
          description: Unique identifier (Kubernetes UID)
          example: 550e8400-e29b-41d4-a716-446655440000
        labels:
          type: object
          description: Map of string keys and values for organizing resources
          additionalProperties:
            type: string
        annotations:
          type: object
          description: Map of string keys and values for storing auxiliary data
          additionalProperties:
            type: string
        creationTimestamp:
          type: string
          format: date-time
          description: Creation timestamp
          example: "2025-01-06T10:00:00Z"

    Condition:
      type: object
      description: Kubernetes-style condition
      required:
        - type
        - status
        - lastTransitionTime
        - reason
      properties:
        type:
          type: string
          description: Type of condition (e.g., Ready)
          example: Ready
        status:
          type: string
          description: Status of the condition
          enum: ["True", "False", "Unknown"]
          example: "True"
        observedGeneration:
          type: integer
          format: int64
          description: Generation observed when this condition was set
        lastTransitionTime:
          type: string
          format: date-time
          description: Last time the condition transitioned
          example: "2025-01-06T10:00:05Z"
        reason:
          type: string
          description: Machine-readable reason for the condition
          example: Reconciled
        message:
          type: string
          description: Human-readable message
          example: "Project is ready"

    # -------------------------------------------------------------------------
    # Version
    # -------------------------------------------------------------------------
    VersionResponse:
      type: object
      description: Server version information
      required:
        - name
        - version
        - gitRevision
        - buildTime
        - goOS
        - goArch
        - goVersion
      properties:
        name:
          type: string
          description: Application name
          example: openchoreo-api
        version:
          type: string
          description: Version string
          example: v0.1.0
        gitRevision:
          type: string
          description: Git commit SHA
          example: abc1234
        buildTime:
          type: string
          description: Build timestamp
          example: "2025-01-06T10:00:00Z"
        goOS:
          type: string
          description: Target operating system
          example: linux
        goArch:
          type: string
          description: Target architecture
          example: amd64
        goVersion:
          type: string
          description: Go version used to build
          example: go1.24.2

    # -------------------------------------------------------------------------
    # OAuth Protected Resource Metadata
    # -------------------------------------------------------------------------
    OAuthProtectedResourceMetadata:
      type: object
      description: OAuth 2.0 protected resource metadata as defined in RFC 9728
      required:
        - resource_name
        - resource
        - authorization_servers
        - bearer_methods_supported
        - scopes_supported
      properties:
        resource_name:
          type: string
          description: Human-readable name of the protected resource
          example: OpenChoreo MCP Server
        resource:
          type: string
          description: URL of the protected resource
          example: https://api.openchoreo.dev/mcp
        authorization_servers:
          type: array
          description: List of authorization server URLs
          items:
            type: string
          example:
            - https://auth.openchoreo.dev
        bearer_methods_supported:
          type: array
          description: Supported bearer token methods
          items:
            type: string
          example:
            - header
        scopes_supported:
          type: array
          description: Supported OAuth scopes
          items:
            type: string

    # -------------------------------------------------------------------------
    # Client Configuration
    # -------------------------------------------------------------------------
    ExternalClient:
      type: object
      description: External client configuration
      required:
        - name
        - client_id
        - scopes
      properties:
        name:
          type: string
          description: Name of the external client
          example: cli
        client_id:
          type: string
          description: OAuth2 client ID for this client type
          example: openchoreo-cli
        scopes:
          type: array
          description: OAuth2 scopes for this client
          items:
            type: string
          example: ["openid", "profile", "email"]

    ClientConfigList:
      type: object
      description: OpenID Connect configuration response
      required:
        - token_endpoint
        - authorization_endpoint
        - external_clients
        - security_enabled
      properties:
        issuer:
          type: string
          description: OIDC issuer URL
          example: https://auth.openchoreo.dev
        token_endpoint:
          type: string
          description: OAuth2 token endpoint URL
          example: https://auth.openchoreo.dev/oauth2/token
        authorization_endpoint:
          type: string
          description: OAuth2 authorization endpoint URL
          example: https://auth.openchoreo.dev/authorize
        security_enabled:
          type: boolean
          description: Whether authentication is enabled on the server
          example: true
        external_clients:
          type: array
          description: Array of external client configurations
          items:
            $ref: '#/components/schemas/ExternalClient'

    # -------------------------------------------------------------------------
    # User Type Configuration
    # -------------------------------------------------------------------------
    UserTypeConfig:
      type: object
      description: Configuration for a user type used in authentication and authorization
      required:
        - type
        - displayName
        - priority
        - authMechanisms
      properties:
        type:
          type: string
          description: User type identifier (e.g., "user", "service_account")
          example: user
        displayName:
          type: string
          description: Human-readable name for the user type
          example: Human User
        priority:
          type: integer
          description: Check order for user type detection (lower = higher priority)
          example: 1
        authMechanisms:
          type: array
          description: Supported authentication mechanisms for this user type
          items:
            $ref: '#/components/schemas/AuthMechanismConfig'

    AuthMechanismConfig:
      type: object
      description: Configuration for an authentication mechanism
      required:
        - type
        - entitlement
      properties:
        type:
          type: string
          description: Authentication mechanism type (e.g., "jwt", "oauth2", "api_key")
          example: jwt
        entitlement:
          $ref: '#/components/schemas/EntitlementConfig'

    EntitlementConfig:
      type: object
      description: Configuration for extracting entitlement claims from tokens
      required:
        - claim
        - displayName
      properties:
        claim:
          type: string
          description: Claim name for detection and entitlement (e.g., "groups", "scopes")
          example: groups
        displayName:
          type: string
          description: Human-readable name for the claim
          example: Groups

    # -------------------------------------------------------------------------
    # Pagination
    # -------------------------------------------------------------------------
    Pagination:
      type: object
      description: |
        Cursor-based pagination metadata. Uses Kubernetes-native continuation tokens
        for efficient pagination through large result sets.
      properties:
        nextCursor:
          type: string
          description: |
            Opaque cursor for fetching the next page. Pass this value as the
            `cursor` query parameter in the next request. Absent when there
            are no more items.
          example: "eyJ2IjoibWV0YS5rOHMuaW8vdjEiLCJydiI6MzQ0N30="
        remainingCount:
          type: integer
          format: int64
          description: |
            Approximate number of items remaining after this page.
            This is an estimate provided by Kubernetes and may not be exact.
            Use for UI hints like "~50 more items". May be absent for
            filtered queries.
          example: 42

    # -------------------------------------------------------------------------
    # Namespaces
    # -------------------------------------------------------------------------
    NamespaceList:
      type: object
      description: Paginated list of namespaces
      required:
        - items
        - pagination
      properties:
        items:
          type: array
          items:
            $ref: '#/components/schemas/Namespace'
        pagination:
          $ref: '#/components/schemas/Pagination'

    Namespace:
      type: object
      description: |
        Namespace resource representing an OpenChoreo control plane namespace.
        Control plane namespaces hold resources like Projects, Components, and Environments.
        These namespaces are identified by the label `openchoreo.dev/controlplane-namespace=true`.
      required:
        - name
        - createdAt
      properties:
        name:
          type: string
          description: Namespace name (unique identifier)
          example: my-namespace
        displayName:
          type: string
          description: Human-readable display name
          example: My Namespace
        description:
          type: string
          description: Namespace description
          example: Main development namespace
        namespace:
          type: string
          description: Kubernetes namespace for the namespace
          example: my-namespace
        createdAt:
          type: string
          format: date-time
          description: Creation timestamp
          example: "2025-01-06T10:00:00Z"
        status:
          type: string
          description: Namespace status
          example: Ready

    CreateNamespaceRequest:
      type: object
      description: Request body for creating a new control plane namespace
      required:
        - name
      properties:
        name:
          type: string
          description: Namespace name (unique identifier, must be a valid Kubernetes namespace name)
          pattern: '^[a-z0-9]([-a-z0-9]*[a-z0-9])?$'
          minLength: 1
          maxLength: 63
          example: my-namespace
        displayName:
          type: string
          description: Human-readable display name
          maxLength: 100
          example: My Namespace
        description:
          type: string
          description: Namespace description
          maxLength: 500
          example: Namespace for development team

    # -------------------------------------------------------------------------
    # Projects
    # -------------------------------------------------------------------------
    BuildPlaneRef:
      type: object
      description: Reference to a BuildPlane or ClusterBuildPlane
      required:
        - kind
        - name
      properties:
        kind:
          type: string
          description: Kind of build plane
          enum: [BuildPlane, ClusterBuildPlane]
          example: BuildPlane
        name:
          type: string
          description: Name of the build plane resource
          example: default

    ProjectSpec:
      type: object
      description: Desired state of a Project
      properties:
        deploymentPipelineRef:
          type: string
          description: |
            Reference to the DeploymentPipeline that defines the environments
            and deployment progression for components in this project.
          example: default
        buildPlaneRef:
          $ref: '#/components/schemas/BuildPlaneRef'

    ProjectStatus:
      type: object
      description: Observed state of a Project
      properties:
        observedGeneration:
          type: integer
          format: int64
          description: Generation of the most recently observed Project
        conditions:
          type: array
          description: Current state conditions of the Project
          items:
            $ref: '#/components/schemas/Condition'

    Project:
      type: object
      description: |
        Project resource (Kubernetes object without kind/apiVersion).
        Projects group components within a namespace and reference a deployment pipeline.
      required:
        - metadata
      properties:
        metadata:
          $ref: '#/components/schemas/ObjectMeta'
        spec:
          $ref: '#/components/schemas/ProjectSpec'
        status:
          readOnly: true
          allOf:
            - $ref: '#/components/schemas/ProjectStatus'

    ProjectList:
      type: object
      description: Paginated list of projects
      required:
        - items
      properties:
        items:
          type: array
          items:
            $ref: '#/components/schemas/Project'
        pagination:
          $ref: '#/components/schemas/Pagination'


    # -------------------------------------------------------------------------
    # Components
    # -------------------------------------------------------------------------
    ComponentList:
      type: object
      description: Paginated list of components
      required:
        - items
      properties:
        items:
          type: array
          items:
            $ref: '#/components/schemas/Component'
        pagination:
          $ref: '#/components/schemas/Pagination'

    ComponentSpec:
      type: object
      description: Desired state of a Component
      required:
        - owner
        - componentType
      properties:
        owner:
          type: object
          description: Ownership information for the component
          required:
            - projectName
          properties:
            projectName:
              type: string
              description: Name of the project this component belongs to
              example: my-project
        componentType:
          type: object
          description: Reference to the ComponentType or ClusterComponentType
          required:
            - name
          properties:
            kind:
              type: string
              description: Kind of component type (ComponentType or ClusterComponentType)
              enum: [ComponentType, ClusterComponentType]
              default: ComponentType
            name:
              type: string
              description: "Component type reference in format: {workloadType}/{componentTypeName}"
              example: deployment/go-service
              pattern: '^(deployment|statefulset|cronjob|job|proxy)/[a-z0-9]([-a-z0-9]*[a-z0-9])?$'
        autoDeploy:
          type: boolean
          description: Whether to automatically deploy to default environment when created
          default: false
          example: true
        autoBuild:
          type: boolean
          description: Whether to automatically trigger builds on code push
          example: false
        parameters:
          type: object
          description: ComponentType parameter values (schema defined by the referenced ComponentType)
          additionalProperties: true
        traits:
          type: array
          description: Trait instances attached to the component
          items:
            $ref: '#/components/schemas/ComponentTrait'
        workflow:
          $ref: '#/components/schemas/ComponentWorkflowConfig'

    ComponentStatus:
      type: object
      description: Observed state of a Component
      properties:
        observedGeneration:
          type: integer
          format: int64
          description: Generation of the most recently observed Component
        conditions:
          type: array
          description: Current state conditions of the Component
          items:
            $ref: '#/components/schemas/Condition'
        latestRelease:
          type: object
          description: Information about the latest ComponentRelease created for this component
          properties:
            name:
              type: string
              description: Name of the latest ComponentRelease resource
              example: my-component-abc123
            releaseHash:
              type: string
              description: Hash of the latest ComponentRelease spec
              example: sha256:abc123

    Component:
      type: object
      description: |
        Component resource (Kubernetes object without kind/apiVersion).
        Components group source code and deployment configuration within a project.
      required:
        - metadata
      properties:
        metadata:
          $ref: '#/components/schemas/ObjectMeta'
        spec:
          $ref: '#/components/schemas/ComponentSpec'
        status:
          readOnly: true
          allOf:
            - $ref: '#/components/schemas/ComponentStatus'

    ComponentWorkflowConfig:
      type: object
      description: Component workflow configuration
      properties:
        name:
          type: string
          description: Workflow name
          example: docker-build
        systemParameters:
          type: object
          description: System-managed parameters (repository info)
          properties:
            repository:
              type: object
              properties:
                url:
                  type: string
                  description: Git repository URL
                  example: https://github.com/org/repo.git
                revision:
                  type: object
                  properties:
                    branch:
                      type: string
                      description: Git branch
                      example: main
                    commit:
                      type: string
                      description: Git commit SHA
                      example: abc1234
                appPath:
                  type: string
                  description: Path to application within repository
                  example: ./services/api
        parameters:
          type: object
          description: User-defined workflow parameters
          additionalProperties: true

    CreateComponentRequest:
      type: object
      description: Request to create a new component
      required:
        - name
      properties:
        name:
          type: string
          description: Component name (must be unique within project)
          example: api-service
          minLength: 1
          maxLength: 63
          pattern: '^[a-z0-9]([-a-z0-9]*[a-z0-9])?$'
        displayName:
          type: string
          description: Human-readable display name
          example: API Service
          maxLength: 256
        description:
          type: string
          description: Component description
          example: Main REST API service
          maxLength: 1024
        type:
          type: string
          description: "DEPRECATED: Use componentType instead. Legacy component type field."
          example: service/go-service
          deprecated: true
        componentType:
          type: string
          description: "Component type reference (format: {workloadType}/{componentTypeName})"
          example: service/go-service
        autoDeploy:
          type: boolean
          description: Whether to automatically deploy to default environment
          default: false
          example: true
        parameters:
          type: object
          description: Component type parameters
          additionalProperties: true
        traits:
          type: array
          description: Trait instances to attach to the component
          items:
            $ref: '#/components/schemas/ComponentTraitInput'
        workflow:
          $ref: '#/components/schemas/ComponentWorkflowInput'

    ComponentTraitInput:
      type: object
      description: Trait instance to attach to a component
      required:
        - name
        - instanceName
      properties:
        kind:
          type: string
          description: Kind of trait resource (Trait for namespace-scoped, ClusterTrait for cluster-scoped)
          enum: [Trait, ClusterTrait]
          default: Trait
          example: Trait
        name:
          type: string
          description: Trait resource name
          example: autoscaler
        instanceName:
          type: string
          description: Unique instance name within the component
          example: api-autoscaler
        parameters:
          type: object
          description: Trait parameter values
          additionalProperties: true

    ComponentWorkflowInput:
      type: object
      description: Workflow configuration for component creation
      required:
        - name
        - systemParameters
      properties:
        name:
          type: string
          description: ComponentWorkflow resource name
          example: docker-build
        systemParameters:
          type: object
          description: System parameters including repository configuration
          required:
            - repository
          properties:
            repository:
              type: object
              required:
                - url
                - revision
                - appPath
              properties:
                url:
                  type: string
                  description: Git repository URL
                  example: https://github.com/org/repo.git
                revision:
                  type: object
                  required:
                    - branch
                  properties:
                    branch:
                      type: string
                      description: Git branch to build from
                      example: main
                    commit:
                      type: string
                      description: Specific commit SHA (optional)
                      example: abc1234
                appPath:
                  type: string
                  description: Path to application within repository
                  example: ./services/api
        parameters:
          type: object
          description: User-defined workflow parameters
          additionalProperties: true

    # -------------------------------------------------------------------------
    # Environments
    # -------------------------------------------------------------------------
    EnvironmentSpec:
      type: object
      description: Desired state of an Environment
      properties:
        dataPlaneRef:
          type: object
          description: |
            Reference to the DataPlane or ClusterDataPlane for this environment.
            If not specified, defaults to a DataPlane named "default" in the same namespace.
            Immutable once set.
          properties:
            kind:
              type: string
              description: Kind of data plane (DataPlane or ClusterDataPlane)
              enum: [DataPlane, ClusterDataPlane]
              example: DataPlane
            name:
              type: string
              description: Name of the data plane resource
              example: default
          required:
            - kind
            - name
        isProduction:
          type: boolean
          description: Whether this is a production environment
          example: false
        gateway:
          type: object
          description: Gateway configuration for the environment
          properties:
            publicVirtualHost:
              type: string
              description: Public virtual host for the gateway
            organizationVirtualHost:
              type: string
              description: Organization-specific virtual host for the gateway

    EnvironmentStatus:
      type: object
      description: Observed state of an Environment
      properties:
        observedGeneration:
          type: integer
          format: int64
          description: Generation of the most recently observed Environment
        conditions:
          type: array
          description: Current state conditions of the Environment
          items:
            $ref: '#/components/schemas/Condition'

    Environment:
      type: object
      description: |
        Environment resource (Kubernetes object without kind/apiVersion).
        Environments represent deployment targets within a namespace.
      required:
        - metadata
      properties:
        metadata:
          $ref: '#/components/schemas/ObjectMeta'
        spec:
          $ref: '#/components/schemas/EnvironmentSpec'
        status:
          readOnly: true
          allOf:
            - $ref: '#/components/schemas/EnvironmentStatus'

    EnvironmentList:
      type: object
      description: Paginated list of environments
      required:
        - items
      properties:
        items:
          type: array
          items:
            $ref: '#/components/schemas/Environment'
        pagination:
          $ref: '#/components/schemas/Pagination'

    ObserverURLResponse:
      type: object
      description: Observer URL response for accessing logs and metrics
      properties:
        observerUrl:
          type: string
          description: URL to the observer service for logs and metrics
          example: https://observer.example.com/api/v1
        message:
          type: string
          description: Additional information or status message
          example: Observer URL is available

    RCAAgentURLResponse:
      type: object
      description: RCA agent URL response for AI-powered root cause analysis
      properties:
        rcaAgentUrl:
          type: string
          description: URL to the RCA agent service for AI-powered root cause analysis
          example: https://rca-agent.example.com
        message:
          type: string
          description: Additional information or status message
          example: RCA agent URL is available

    # -------------------------------------------------------------------------
    # DataPlanes
    # -------------------------------------------------------------------------
    DataPlaneList:
      type: object
      description: Paginated list of data planes
      required:
        - items
      properties:
        items:
          type: array
          items:
            $ref: '#/components/schemas/DataPlane'
        pagination:
          $ref: '#/components/schemas/Pagination'

    DataPlane:
      type: object
      description: |
        DataPlane resource (Kubernetes object without kind/apiVersion).
        Represents a Kubernetes cluster for workload deployment.
      required:
        - metadata
      properties:
        metadata:
          $ref: '#/components/schemas/ObjectMeta'
        spec:
          $ref: '#/components/schemas/DataPlaneSpec'
        status:
          readOnly: true
          allOf:
            - $ref: '#/components/schemas/DataPlaneStatus'

    DataPlaneSpec:
      type: object
      description: Desired state of a DataPlane
      properties:
        planeID:
          type: string
          description: |
            Logical plane identifier for the physical cluster.
            Multiple DataPlane CRs can share the same planeID.
          example: prod-cluster
        clusterAgent:
          $ref: '#/components/schemas/ClusterAgentConfig'
        gateway:
          $ref: '#/components/schemas/GatewaySpec'
        imagePullSecretRefs:
          type: array
          description: References to SecretReference resources for image pulling
          items:
            type: string
          example: ["docker-registry-secret"]
        secretStoreRef:
          $ref: '#/components/schemas/SecretStoreRef'
        observabilityPlaneRef:
          $ref: '#/components/schemas/ObservabilityPlaneRef'

    DataPlaneStatus:
      type: object
      description: Observed state of a DataPlane
      properties:
        observedGeneration:
          type: integer
          format: int64
          description: Generation of the most recently observed DataPlane
        conditions:
          type: array
          description: Current state conditions of the DataPlane
          items:
            $ref: '#/components/schemas/Condition'
        agentConnection:
          $ref: '#/components/schemas/AgentConnectionStatus'

    GatewaySpec:
      type: object
      description: Gateway configuration for a data plane
      properties:
        publicVirtualHost:
          type: string
          description: Public virtual host for external traffic
          example: apps.example.com
        organizationVirtualHost:
          type: string
          description: Organization-specific virtual host
          example: internal.example.com
        publicHTTPPort:
          type: integer
          format: int32
          description: Public HTTP port
          example: 19080
        publicHTTPSPort:
          type: integer
          format: int32
          description: Public HTTPS port
          example: 19443
        organizationHTTPPort:
          type: integer
          format: int32
          description: Organization HTTP port
          example: 19081
        organizationHTTPSPort:
          type: integer
          format: int32
          description: Organization HTTPS port
          example: 19444
        publicGatewayName:
          type: string
          description: Name of the public Gateway resource
          example: gateway-default
        publicGatewayNamespace:
          type: string
          description: Namespace of the public Gateway resource
          example: openchoreo-data-plane
        organizationGatewayName:
          type: string
          description: Name of the organization Gateway resource
          example: gateway-default
        organizationGatewayNamespace:
          type: string
          description: Namespace of the organization Gateway resource
          example: openchoreo-data-plane

    # -------------------------------------------------------------------------
    # BuildPlanes
    # -------------------------------------------------------------------------
    BuildPlaneList:
      type: object
      description: Paginated list of build planes
      required:
        - items
      properties:
        items:
          type: array
          items:
            $ref: '#/components/schemas/BuildPlane'
        pagination:
          $ref: '#/components/schemas/Pagination'

    BuildPlane:
      type: object
      description: |
        BuildPlane resource (Kubernetes object without kind/apiVersion).
        Represents CI/CD build infrastructure within a namespace.
      required:
        - metadata
      properties:
        metadata:
          $ref: '#/components/schemas/ObjectMeta'
        spec:
          $ref: '#/components/schemas/BuildPlaneSpec'
        status:
          readOnly: true
          allOf:
            - $ref: '#/components/schemas/BuildPlaneStatus'

    BuildPlaneSpec:
      type: object
      description: Desired state of a BuildPlane
      properties:
        planeID:
          type: string
          description: |
            Logical plane identifier for the physical cluster.
            Multiple BuildPlane CRs can share the same planeID.
          example: ci-cluster
        clusterAgent:
          $ref: '#/components/schemas/ClusterAgentConfig'
        secretStoreRef:
          $ref: '#/components/schemas/SecretStoreRef'
        observabilityPlaneRef:
          $ref: '#/components/schemas/ObservabilityPlaneRef'

    BuildPlaneStatus:
      type: object
      description: Observed state of a BuildPlane
      properties:
        observedGeneration:
          type: integer
          format: int64
          description: Generation of the most recently observed BuildPlane
        conditions:
          type: array
          description: Current state conditions of the BuildPlane
          items:
            $ref: '#/components/schemas/Condition'
        agentConnection:
          $ref: '#/components/schemas/AgentConnectionStatus'

    ClusterAgentConfig:
      type: object
      description: Configuration for cluster agent-based communication
      properties:
        clientCA:
          $ref: '#/components/schemas/ValueFrom'

    ValueFrom:
      type: object
      description: Reference to a secret or inline value
      properties:
        secretRef:
          $ref: '#/components/schemas/SecretKeyReference'
        value:
          type: string
          description: Inline value (optional fallback)

    SecretKeyReference:
      type: object
      description: Reference to a specific key in a Kubernetes secret
      properties:
        name:
          type: string
          description: Name of the secret
        namespace:
          type: string
          description: Namespace of the secret
        key:
          type: string
          description: Key within the secret

    SecretStoreRef:
      type: object
      description: Reference to an External Secrets Operator ClusterSecretStore
      properties:
        name:
          type: string
          description: Name of the ClusterSecretStore resource

    AgentConnectionStatus:
      type: object
      description: Status of cluster agent connections
      properties:
        connected:
          type: boolean
          description: Whether any cluster agent is currently connected
        connectedAgents:
          type: integer
          description: Number of cluster agents currently connected
        lastConnectedTime:
          type: string
          format: date-time
          description: When an agent last successfully connected
        lastDisconnectedTime:
          type: string
          format: date-time
          description: When the last agent disconnected
        lastHeartbeatTime:
          type: string
          format: date-time
          description: When control plane last received communication from an agent
        message:
          type: string
          description: Additional information about agent connection status

    # -------------------------------------------------------------------------
    # ObservabilityPlaneRef
    # -------------------------------------------------------------------------
    ObservabilityPlaneRef:
      type: object
      description: Reference to an ObservabilityPlane or ClusterObservabilityPlane
      required:
        - kind
        - name
      properties:
        kind:
          type: string
          description: Kind of observability plane (ObservabilityPlane or ClusterObservabilityPlane)
          enum: [ObservabilityPlane, ClusterObservabilityPlane]
          example: ObservabilityPlane
        name:
          type: string
          description: Name of the observability plane resource. Must be a valid DNS-1123 label.
          minLength: 1
          maxLength: 63
          pattern: '^[a-z0-9]([-a-z0-9]*[a-z0-9])?$'
          example: default

    # -------------------------------------------------------------------------
    # ObservabilityPlanes
    # -------------------------------------------------------------------------
    ObservabilityPlaneList:
      type: object
      description: Paginated list of observability planes
      required:
        - items
      properties:
        items:
          type: array
          items:
            $ref: '#/components/schemas/ObservabilityPlane'
        pagination:
          $ref: '#/components/schemas/Pagination'

    ObservabilityPlane:
      type: object
      description: |
        ObservabilityPlane resource (Kubernetes object without kind/apiVersion).
        Represents monitoring and logging infrastructure within a namespace.
      required:
        - metadata
      properties:
        metadata:
          $ref: '#/components/schemas/ObjectMeta'
        spec:
          $ref: '#/components/schemas/ObservabilityPlaneSpec'
        status:
          readOnly: true
          allOf:
            - $ref: '#/components/schemas/ObservabilityPlaneStatus'

    ObservabilityPlaneSpec:
      type: object
      description: Desired state of an ObservabilityPlane
      properties:
        planeID:
          type: string
          description: |
            Logical plane identifier for the physical cluster.
            Multiple ObservabilityPlane CRs can share the same planeID.
          example: shared-obs
        clusterAgent:
          $ref: '#/components/schemas/ClusterAgentConfig'
        observerURL:
          type: string
          description: Base URL of the Observer API in the observability plane cluster
          example: http://observer.observability-plane.svc:8080
        rcaAgentURL:
          type: string
          description: Base URL of the RCA Agent API in the observability plane cluster
          example: http://rca-agent.observability-plane.svc:8080

    ObservabilityPlaneStatus:
      type: object
      description: Observed state of an ObservabilityPlane
      properties:
        observedGeneration:
          type: integer
          format: int64
          description: Generation of the most recently observed ObservabilityPlane
        conditions:
          type: array
          description: Current state conditions of the ObservabilityPlane
          items:
            $ref: '#/components/schemas/Condition'
        agentConnection:
          $ref: '#/components/schemas/AgentConnectionStatus'

    # -------------------------------------------------------------------------
    # ClusterDataPlanes (Cluster-Scoped)
    # -------------------------------------------------------------------------
    ClusterDataPlaneList:
      type: object
      description: Paginated list of cluster-scoped data planes
      required:
        - items
      properties:
        items:
          type: array
          items:
            $ref: '#/components/schemas/ClusterDataPlane'
        pagination:
          $ref: '#/components/schemas/Pagination'

    ClusterDataPlane:
      type: object
      description: |
        ClusterDataPlane resource (Kubernetes object without kind/apiVersion).
        Represents a cluster-scoped data plane for workload deployment.
      required:
        - metadata
      properties:
        metadata:
          $ref: '#/components/schemas/ObjectMeta'
        spec:
          $ref: '#/components/schemas/ClusterDataPlaneSpec'
        status:
          readOnly: true
          allOf:
            - $ref: '#/components/schemas/ClusterDataPlaneStatus'

    ClusterDataPlaneSpec:
      type: object
      description: Desired state of a ClusterDataPlane
      properties:
        planeID:
          type: string
          description: |
            Logical plane identifier for the physical cluster.
            Multiple ClusterDataPlane CRs can share the same planeID.
          example: us-west-prod-cluster
        clusterAgent:
          $ref: '#/components/schemas/ClusterAgentConfig'
        gateway:
          $ref: '#/components/schemas/GatewaySpec'
        imagePullSecretRefs:
          type: array
          description: References to SecretReference resources for image pulling
          items:
            type: string
          example: ["docker-registry-secret"]
        secretStoreRef:
          $ref: '#/components/schemas/SecretStoreRef'
        observabilityPlaneRef:
          $ref: '#/components/schemas/ClusterObservabilityPlaneRef'

    ClusterDataPlaneStatus:
      type: object
      description: Observed state of a ClusterDataPlane
      properties:
        observedGeneration:
          type: integer
          format: int64
          description: Generation of the most recently observed ClusterDataPlane
        conditions:
          type: array
          description: Current state conditions of the ClusterDataPlane
          items:
            $ref: '#/components/schemas/Condition'
        agentConnection:
          $ref: '#/components/schemas/AgentConnectionStatus'

    # -------------------------------------------------------------------------
    # ClusterBuildPlanes (Cluster-Scoped)
    # -------------------------------------------------------------------------
    ClusterBuildPlaneList:
      type: object
      description: List of cluster-scoped build planes
      required:
        - items
      properties:
        items:
          type: array
          items:
            $ref: '#/components/schemas/ClusterBuildPlane'
        pagination:
          $ref: '#/components/schemas/Pagination'

    ClusterBuildPlane:
      type: object
      description: |
        ClusterBuildPlane resource (Kubernetes object without kind/apiVersion).
        Represents cluster-scoped CI/CD build infrastructure.
      required:
        - metadata
      properties:
        metadata:
          $ref: '#/components/schemas/ObjectMeta'
        spec:
          $ref: '#/components/schemas/ClusterBuildPlaneSpec'
        status:
          readOnly: true
          allOf:
            - $ref: '#/components/schemas/ClusterBuildPlaneStatus'

    ClusterBuildPlaneSpec:
      type: object
      description: Desired state of a ClusterBuildPlane
      properties:
        planeID:
          type: string
          description: |
            Logical plane identifier for the physical cluster.
            Multiple ClusterBuildPlane CRs can share the same planeID.
          example: ci-cluster
        clusterAgent:
          $ref: '#/components/schemas/ClusterAgentConfig'
        secretStoreRef:
          $ref: '#/components/schemas/SecretStoreRef'
        observabilityPlaneRef:
          $ref: '#/components/schemas/ClusterObservabilityPlaneRef'

    ClusterBuildPlaneStatus:
      type: object
      description: Observed state of a ClusterBuildPlane
      properties:
        observedGeneration:
          type: integer
          format: int64
          description: Generation of the most recently observed ClusterBuildPlane
        conditions:
          type: array
          description: Current state conditions of the ClusterBuildPlane
          items:
            $ref: '#/components/schemas/Condition'
        agentConnection:
          $ref: '#/components/schemas/AgentConnectionStatus'

    # -------------------------------------------------------------------------
    # ClusterObservabilityPlaneRef (Cluster-Scoped Only)
    # -------------------------------------------------------------------------
    ClusterObservabilityPlaneRef:
      type: object
      description: Reference to a ClusterObservabilityPlane (cluster-scoped only)
      required:
        - kind
        - name
      properties:
        kind:
          type: string
          description: Kind of observability plane (only ClusterObservabilityPlane allowed)
          enum: [ClusterObservabilityPlane]
          example: ClusterObservabilityPlane
        name:
          type: string
          description: Name of the ClusterObservabilityPlane resource
          minLength: 1
          maxLength: 63
          pattern: '^[a-z0-9]([-a-z0-9]*[a-z0-9])?$'
          example: default

    # -------------------------------------------------------------------------
    # ClusterObservabilityPlanes (Cluster-Scoped)
    # -------------------------------------------------------------------------
    ClusterObservabilityPlaneList:
      type: object
      description: List of cluster-scoped observability planes
      required:
        - items
      properties:
        items:
          type: array
          items:
            $ref: '#/components/schemas/ClusterObservabilityPlane'
        pagination:
          $ref: '#/components/schemas/Pagination'

    ClusterObservabilityPlane:
      type: object
      description: |
        ClusterObservabilityPlane resource (Kubernetes object without kind/apiVersion).
        Represents cluster-scoped monitoring and logging infrastructure.
      required:
        - metadata
      properties:
        metadata:
          $ref: '#/components/schemas/ObjectMeta'
        spec:
          $ref: '#/components/schemas/ClusterObservabilityPlaneSpec'
        status:
          readOnly: true
          allOf:
            - $ref: '#/components/schemas/ClusterObservabilityPlaneStatus'

    ClusterObservabilityPlaneSpec:
      type: object
      description: Desired state of a ClusterObservabilityPlane
      properties:
        planeID:
          type: string
          description: |
            Logical plane identifier for the physical cluster.
            Multiple ClusterObservabilityPlane CRs can share the same planeID.
          example: monitoring-cluster
        clusterAgent:
          $ref: '#/components/schemas/ClusterAgentConfig'
        observerURL:
          type: string
          description: Base URL of the Observer API in the observability plane cluster
          example: http://observer.observability-plane.svc:8080
        rcaAgentURL:
          type: string
          description: Base URL of the RCA Agent API in the observability plane cluster
          example: http://rca-agent.observability-plane.svc:8080

    ClusterObservabilityPlaneStatus:
      type: object
      description: Observed state of a ClusterObservabilityPlane
      properties:
        observedGeneration:
          type: integer
          format: int64
          description: Generation of the most recently observed ClusterObservabilityPlane
        conditions:
          type: array
          description: Current state conditions of the ClusterObservabilityPlane
          items:
            $ref: '#/components/schemas/Condition'
        agentConnection:
          $ref: '#/components/schemas/AgentConnectionStatus'

    # -------------------------------------------------------------------------
    # ClusterComponentTypes
    # -------------------------------------------------------------------------
    ClusterComponentTypeList:
      type: object
      description: Paginated list of cluster-scoped component types
      required:
        - items
        - pagination
      properties:
        items:
          type: array
          items:
            $ref: '#/components/schemas/ClusterComponentType'
        pagination:
          $ref: '#/components/schemas/Pagination'

    ClusterComponentType:
      type: object
      description: Cluster-scoped ComponentType resource defining a workload template
      required:
        - name
        - workloadType
        - createdAt
      properties:
        name:
          type: string
          description: ClusterComponentType name (unique across the cluster)
          example: go-service
        displayName:
          type: string
          description: Human-readable display name
          example: Go Service
        description:
          type: string
          description: ComponentType description
          example: Template for Go-based microservices
        workloadType:
          type: string
          description: Type of workload (service, web-application, scheduled-task)
          example: service
        allowedWorkflows:
          type: array
          description: List of allowed workflow names for this component type
          items:
            type: string
          example: ["docker-build", "buildpack-build"]
        allowedTraits:
          type: array
          description: >-
            List of allowed trait references that developers can attach to components of this type
            (format "name" for Trait kind, "ClusterTrait:name" for ClusterTrait kind).
            If empty or omitted, no additional component-level traits are allowed;
            only traits embedded in the component type's spec.traits are permitted.
          items:
            type: string
          example: ["autoscaler", "ClusterTrait:logger"]
        createdAt:
          type: string
          format: date-time
          description: Creation timestamp
          example: "2025-01-06T10:00:00Z"

    # -------------------------------------------------------------------------
    # ClusterTraits
    # -------------------------------------------------------------------------
    ClusterTraitList:
      type: object
      description: Paginated list of cluster-scoped traits
      required:
        - items
        - pagination
      properties:
        items:
          type: array
          items:
            $ref: '#/components/schemas/ClusterTrait'
        pagination:
          $ref: '#/components/schemas/Pagination'

    ClusterTrait:
      type: object
      description: Cluster-scoped Trait resource for composable cross-cutting concerns
      required:
        - name
        - createdAt
      properties:
        name:
          type: string
          description: ClusterTrait name (unique across the cluster)
          example: autoscaler
        displayName:
          type: string
          description: Human-readable display name
          example: Auto Scaler
        description:
          type: string
          description: Trait description
          example: Enables horizontal pod autoscaling
        createdAt:
          type: string
          format: date-time
          description: Creation timestamp
          example: "2025-01-06T10:00:00Z"

    # -------------------------------------------------------------------------
    # ComponentTypes
    # -------------------------------------------------------------------------
    ComponentTypeList:
      type: object
      description: Paginated list of component types
      required:
        - items
      properties:
        items:
          type: array
          items:
            $ref: '#/components/schemas/ComponentType'
        pagination:
          $ref: '#/components/schemas/Pagination'

    ComponentTypeSpec:
      type: object
      description: Desired state of a ComponentType
      required:
        - workloadType
        - resources
      properties:
        workloadType:
          type: string
          description: Primary workload resource type for this component type
          enum: [deployment, statefulset, cronjob, job, proxy]
          example: deployment
        allowedWorkflows:
          type: array
          description: List of allowed ComponentWorkflow names for this component type
          items:
            type: string
          example: ["docker-build", "buildpack-build"]
        schema:
          type: object
          description: Developer-configurable schema definition
          properties:
            types:
              type: object
              description: Reusable type definitions
              additionalProperties: true
            parameters:
              type: object
              description: Static developer configuration parameters
              additionalProperties: true
            envOverrides:
              type: object
              description: Environment-specific overrides for platform engineers
              additionalProperties: true
        traits:
          type: array
          description: Pre-configured trait instances embedded in this component type
          items:
            type: object
            required:
              - name
              - instanceName
            properties:
              kind:
                type: string
                description: Kind of trait (Trait or ClusterTrait)
                enum: [Trait, ClusterTrait]
                default: Trait
              name:
                type: string
                description: Name of the Trait resource
              instanceName:
                type: string
                description: Unique instance name for this trait
              parameters:
                type: object
                description: Trait parameter bindings (concrete values or CEL expressions)
                additionalProperties: true
              envOverrides:
                type: object
                description: Trait environment override bindings
                additionalProperties: true
        allowedTraits:
          type: array
          description: >-
            Restricts which Trait or ClusterTrait CRs developers can attach to Components of this type.
            Each entry is an object with "kind" (Trait or ClusterTrait, defaults to Trait) and "name".
            For example: {"kind": "Trait", "name": "my-trait"} or {"kind": "ClusterTrait", "name": "my-cluster-trait"}.
            If empty or omitted, no additional component-level traits are permitted
            (only embedded traits defined in spec.traits are allowed).
          items:
            type: object
            required:
              - name
            properties:
              kind:
                type: string
                description: Kind of trait reference
                enum: [Trait, ClusterTrait]
                default: Trait
              name:
                type: string
                description: Name of the Trait or ClusterTrait resource
        validations:
          type: array
          description: CEL-based validation rules evaluated during rendering
          items:
            type: object
            required:
              - rule
              - message
            properties:
              rule:
                type: string
                description: "CEL expression wrapped in ${...} that must evaluate to true"
              message:
                type: string
                description: Error message shown when the rule evaluates to false
        resources:
          type: array
          description: Templates that generate Kubernetes resources dynamically
          minItems: 1
          items:
            type: object
            required:
              - id
              - template
            properties:
              id:
                type: string
                description: Unique identifier for this resource within the component type
              targetPlane:
                type: string
                description: Target plane for deployment
                enum: [dataplane, observabilityplane]
                default: dataplane
              includeWhen:
                type: string
                description: "CEL expression determining if this resource should be created"
              forEach:
                type: string
                description: "CEL expression for generating multiple resources from a list"
              var:
                type: string
                description: Loop variable name when using forEach
              template:
                type: object
                description: Kubernetes resource template with CEL expressions
                additionalProperties: true

    ComponentTypeStatus:
      type: object
      description: Observed state of a ComponentType

    ComponentType:
      type: object
      description: |
        ComponentType resource (Kubernetes object without kind/apiVersion).
        Defines workload templates used by platform engineers to govern component behavior.
      required:
        - metadata
      properties:
        metadata:
          $ref: '#/components/schemas/ObjectMeta'
        spec:
          $ref: '#/components/schemas/ComponentTypeSpec'
        status:
          readOnly: true
          allOf:
            - $ref: '#/components/schemas/ComponentTypeStatus'

    # -------------------------------------------------------------------------
    # Traits
    # -------------------------------------------------------------------------
    TraitList:
      type: object
      description: Paginated list of traits
      required:
        - items
      properties:
        items:
          type: array
          items:
            $ref: '#/components/schemas/Trait'
        pagination:
          $ref: '#/components/schemas/Pagination'

    TraitSpec:
      type: object
      description: Desired state of a Trait
      properties:
        schema:
          type: object
          description: Trait parameter schema definition
          properties:
            types:
              type: object
              description: Reusable type definitions
              additionalProperties: true
            parameters:
              type: object
              description: Developer-facing configuration options
              additionalProperties: true
            envOverrides:
              type: object
              description: Environment-specific overrides
              additionalProperties: true
        validations:
          type: array
          description: CEL-based validation rules evaluated during rendering
          items:
            type: object
            required:
              - rule
              - message
            properties:
              rule:
                type: string
                description: "CEL expression wrapped in ${...} that must evaluate to true"
              message:
                type: string
                description: Error message shown when the rule evaluates to false
        creates:
          type: array
          description: New Kubernetes resources to create when this trait is applied
          items:
            type: object
            required:
              - template
            properties:
              targetPlane:
                type: string
                description: Target plane for deployment
                enum: [dataplane, observabilityplane]
                default: dataplane
              includeWhen:
                type: string
                description: "CEL expression determining if this resource should be created"
              forEach:
                type: string
                description: "CEL expression for generating multiple resources from a list"
              var:
                type: string
                description: Loop variable name when using forEach
              template:
                type: object
                description: Kubernetes resource template with CEL expressions
                additionalProperties: true
        patches:
          type: array
          description: Modifications to existing resources generated by the ComponentType
          items:
            type: object
            required:
              - target
              - operations
            properties:
              forEach:
                type: string
                description: "CEL expression for repeating this patch"
              var:
                type: string
                description: Loop variable name when using forEach
              target:
                type: object
                description: Target resource to patch
                required:
                  - group
                  - version
                  - kind
                properties:
                  group:
                    type: string
                    description: API group of the resource
                  version:
                    type: string
                    description: API version of the resource
                  kind:
                    type: string
                    description: Resource type to patch
                  where:
                    type: string
                    description: "CEL expression to filter which resources to patch"
              targetPlane:
                type: string
                description: Target plane for this patch
                enum: [dataplane, observabilityplane]
                default: dataplane
              operations:
                type: array
                description: JSONPatch operations to apply
                minItems: 1
                items:
                  type: object
                  required:
                    - op
                    - path
                  properties:
                    op:
                      type: string
                      description: Operation type
                      enum: [add, replace, remove]
                    path:
                      type: string
                      description: JSON Pointer to the field to modify
                    value:
                      description: Value to set (for add/replace operations)

    TraitStatus:
      type: object
      description: Observed state of a Trait

    Trait:
      type: object
      description: |
        Trait resource (Kubernetes object without kind/apiVersion).
        Defines composable cross-cutting concerns that can be applied to components.
      required:
        - metadata
      properties:
        metadata:
          $ref: '#/components/schemas/ObjectMeta'
        spec:
          $ref: '#/components/schemas/TraitSpec'
        status:
          readOnly: true
          allOf:
            - $ref: '#/components/schemas/TraitStatus'

    # -------------------------------------------------------------------------
    # Schema Response
    # -------------------------------------------------------------------------
    SchemaResponse:
      type: object
      description: JSON Schema response for component types, traits, or workflows
      additionalProperties: true
      example:
        type: object
        properties:
          replicas:
            type: integer
            default: 1
          port:
            type: integer
            default: 8080

    # -------------------------------------------------------------------------
    # Workflows
    # -------------------------------------------------------------------------
    WorkflowList:
      type: object
      description: Paginated list of workflows
      required:
        - items
        - pagination
      properties:
        items:
          type: array
          items:
            $ref: '#/components/schemas/Workflow'
        pagination:
          $ref: '#/components/schemas/Pagination'

    Workflow:
      type: object
      description: Generic workflow resource
      required:
        - name
        - createdAt
      properties:
        name:
          type: string
          description: Workflow name (unique within namespace)
          example: database-migration
        displayName:
          type: string
          description: Human-readable display name
          example: Database Migration
        description:
          type: string
          description: Workflow description
          example: Runs database migration scripts
        createdAt:
          type: string
          format: date-time
          description: Creation timestamp
          example: "2025-01-06T10:00:00Z"

    # -------------------------------------------------------------------------
    # WorkflowRuns
    # -------------------------------------------------------------------------
    WorkflowRunList:
      type: object
      description: Paginated list of workflow runs
      required:
        - items
        - pagination
      properties:
        items:
          type: array
          items:
            $ref: '#/components/schemas/WorkflowRun'
        pagination:
          $ref: '#/components/schemas/Pagination'

    WorkflowRun:
      type: object
      description: Generic workflow run (execution)
      required:
        - name
        - workflowName
        - orgName
        - createdAt
        - status
      properties:
        name:
          type: string
          description: Workflow run name
          example: database-migration-run-1234
        uuid:
          type: string
          description: Unique identifier
          example: 550e8400-e29b-41d4-a716-446655440000
        workflowName:
          type: string
          description: Parent workflow name
          example: database-migration
        orgName:
          type: string
          description: Organization name
          example: my-org
        status:
          type: string
          enum: [Pending, Running, Succeeded, Failed, Error]
          description: Current execution status
          example: Succeeded
        parameters:
          type: object
          description: User-defined workflow parameters
          additionalProperties: true
          example:
            database_url: "postgresql://localhost:5432/mydb"
            migration_version: "v2.1.0"
        createdAt:
          type: string
          format: date-time
          description: Creation timestamp
          example: "2025-01-06T10:00:00Z"
        finishedAt:
          type: string
          format: date-time
          description: Completion timestamp
          example: "2025-01-06T10:05:00Z"
        phase:
          type: string
          description: Detailed execution phase
          example: "Clone completed, build in progress"

    WorkflowRunStatusResponse:
      type: object
      description: Status of a workflow run including per-step details
      required:
        - status
        - steps
        - hasLiveObservability
      properties:
        status:
          type: string
          enum: [Pending, Running, Succeeded, Failed, Error]
          description: Overall workflow run status
          example: Running
        steps:
          type: array
          description: Per-step status details
          items:
            $ref: '#/components/schemas/WorkflowStepStatus'
        hasLiveObservability:
          type: boolean
          description: Whether live logs/events are available from the build plane
          example: true

    WorkflowStepStatus:
      type: object
      description: Status of an individual workflow step
      required:
        - name
        - phase
      properties:
        name:
          type: string
          description: Step name
          example: clone-step
        phase:
          type: string
          description: Step phase
          enum: [Pending, Running, Succeeded, Failed, Skipped, Error]
          example: Succeeded
        startedAt:
          type: string
          format: date-time
          description: When the step started
          example: "2025-01-06T10:00:00Z"
        finishedAt:
          type: string
          format: date-time
          description: When the step finished
          example: "2025-01-06T10:01:00Z"

    WorkflowRunLogEntry:
      type: object
      description: A single log entry from a workflow run
      required:
        - log
      properties:
        timestamp:
          type: string
          format: date-time
          description: Log entry timestamp
          example: "2025-01-06T10:00:00Z"
        log:
          type: string
          description: Log message
          example: "Step 1: Cloning repository..."

    WorkflowRunEventEntry:
      type: object
      description: A single Kubernetes event from a workflow run
      required:
        - timestamp
        - type
        - reason
        - message
      properties:
        timestamp:
          type: string
          format: date-time
          description: Event timestamp
          example: "2025-01-06T10:00:00Z"
        type:
          type: string
          description: Event type
          example: Normal
        reason:
          type: string
          description: Short machine-understandable reason for the event
          example: Started
        message:
          type: string
          description: Human-readable description of the event
          example: "Container main started"

    CreateWorkflowRunRequest:
      type: object
      description: Request to create a new workflow run
      required:
        - workflowName
        - parameters
      properties:
        workflowName:
          type: string
          description: Name of the workflow to execute
          example: database-migration
        parameters:
          type: object
          description: User-defined workflow parameters
          additionalProperties: true
          example:
            database_url: "postgresql://localhost:5432/mydb"
            migration_version: "v2.1.0"

    # -------------------------------------------------------------------------
    # ComponentWorkflows
    # -------------------------------------------------------------------------
    ComponentWorkflowTemplateList:
      type: object
      description: Paginated list of component workflow templates
      required:
        - items
        - pagination
      properties:
        items:
          type: array
          items:
            $ref: '#/components/schemas/ComponentWorkflowTemplate'
        pagination:
          $ref: '#/components/schemas/Pagination'

    ComponentWorkflowTemplate:
      type: object
      description: Component workflow template resource
      required:
        - name
        - createdAt
      properties:
        name:
          type: string
          description: ComponentWorkflow name (unique within namespace)
          example: docker-build
        displayName:
          type: string
          description: Human-readable display name
          example: Docker Build
        description:
          type: string
          description: ComponentWorkflow description
          example: Builds container images using Docker
        createdAt:
          type: string
          format: date-time
          description: Creation timestamp
          example: "2025-01-06T10:00:00Z"

    UpdateComponentWorkflowRequest:
      type: object
      description: Request to update component workflow parameters
      properties:
        workflowName:
          type: string
          description: ComponentWorkflow template name to use
          example: docker-build
        systemParameters:
          type: object
          description: System parameters including repository configuration
          properties:
            repository:
              type: object
              properties:
                url:
                  type: string
                  description: Git repository URL
                  example: https://github.com/org/repo.git
                revision:
                  type: object
                  properties:
                    branch:
                      type: string
                      description: Git branch
                      example: main
                    commit:
                      type: string
                      description: Specific commit SHA
                      example: abc1234
                appPath:
                  type: string
                  description: Path to application within repository
                  example: ./services/api
        parameters:
          type: object
          description: User-defined workflow parameters
          additionalProperties: true

    ComponentWorkflowRunList:
      type: object
      description: Paginated list of component workflow runs
      required:
        - items
        - pagination
      properties:
        items:
          type: array
          items:
            $ref: '#/components/schemas/ComponentWorkflowRun'
        pagination:
          $ref: '#/components/schemas/Pagination'

    ComponentWorkflowRun:
      type: object
      description: Component workflow run (build execution)
      required:
        - name
        - componentName
        - projectName
        - namespaceName
        - createdAt
      properties:
        name:
          type: string
          description: Workflow run name
          example: api-service-run-1234
        uuid:
          type: string
          description: Unique identifier
          example: 550e8400-e29b-41d4-a716-446655440000
        componentName:
          type: string
          description: Parent component name
          example: api-service
        projectName:
          type: string
          description: Parent project name
          example: my-project
        namespaceName:
          type: string
          description: Parent namespace name
          example: my-namespace
        status:
          type: string
          description: Run status
          example: Running
        commit:
          type: string
          description: Git commit SHA being built
          example: abc1234def5678
        image:
          type: string
          description: Built container image
          example: registry.example.com/my-namespace/api-service:abc1234
        workflow:
          $ref: '#/components/schemas/ComponentWorkflowConfig'
        createdAt:
          type: string
          format: date-time
          description: Creation timestamp
          example: "2025-01-06T10:00:00Z"

    # -------------------------------------------------------------------------
    # Component Extended Schemas
    # -------------------------------------------------------------------------
    PatchComponentRequest:
      type: object
      description: Request to patch a component
      properties:
        autoDeploy:
          type: boolean
          description: Controls auto-deployment to default environment
          example: true
        parameters:
          type: object
          description: ComponentType parameters
          additionalProperties: true

    ComponentTraitList:
      type: object
      description: List of component traits
      required:
        - items
      properties:
        items:
          type: array
          items:
            $ref: '#/components/schemas/ComponentTrait'

    ComponentTrait:
      type: object
      description: Trait attached to a component
      required:
        - name
        - instanceName
      properties:
        kind:
          type: string
          description: Kind of trait resource (Trait for namespace-scoped, ClusterTrait for cluster-scoped)
          enum: [Trait, ClusterTrait]
          default: Trait
          example: Trait
        name:
          type: string
          description: Trait template name
          example: autoscaler
        instanceName:
          type: string
          description: Instance name for this trait attachment
          example: my-autoscaler
        parameters:
          type: object
          description: Trait parameters
          additionalProperties: true

    UpdateComponentTraitsRequest:
      type: object
      description: Request to update component traits
      required:
        - traits
      properties:
        traits:
          type: array
          items:
            $ref: '#/components/schemas/ComponentTraitInput'

    # -------------------------------------------------------------------------
    # Bindings
    # -------------------------------------------------------------------------
    BindingList:
      type: object
      description: Paginated list of bindings
      required:
        - items
        - pagination
      properties:
        items:
          type: array
          items:
            $ref: '#/components/schemas/Binding'
        pagination:
          $ref: '#/components/schemas/Pagination'

    Binding:
      type: object
      description: Deployment binding for a component in an environment
      required:
        - name
        - type
        - componentName
        - projectName
        - namespaceName
        - environment
        - status
      properties:
        name:
          type: string
          description: Binding name
          example: api-service-dev
        type:
          type: string
          description: Binding type
          example: service
        componentName:
          type: string
          description: Parent component name
          example: api-service
        projectName:
          type: string
          description: Parent project name
          example: my-project
        namespaceName:
          type: string
          description: Parent namespace name
          example: my-namespace
        environment:
          type: string
          description: Target environment name
          example: dev
        status:
          $ref: '#/components/schemas/BindingStatus'
        serviceBinding:
          $ref: '#/components/schemas/ServiceBinding'
        webApplicationBinding:
          $ref: '#/components/schemas/WebApplicationBinding'
        scheduledTaskBinding:
          $ref: '#/components/schemas/ScheduledTaskBinding'

    BindingStatus:
      type: object
      description: Status of a binding
      properties:
        status:
          type: string
          description: Status type
          enum: [InProgress, Active, Failed, Suspended]
          example: Active
        reason:
          type: string
          description: Human-readable status reason
          example: Deployment complete
        message:
          type: string
          description: Human-readable status message
          example: All replicas are ready
        lastTransitioned:
          type: string
          format: date-time
          description: Last status transition time
          example: "2025-01-06T10:00:00Z"

    EndpointStatus:
      type: object
      description: Status of an exposed endpoint
      properties:
        name:
          type: string
          description: Endpoint name
          example: http
        type:
          type: string
          description: Endpoint type
          example: http
        project:
          $ref: '#/components/schemas/ExposedEndpoint'
        namespace:
          $ref: '#/components/schemas/ExposedEndpoint'
        public:
          $ref: '#/components/schemas/ExposedEndpoint'

    ExposedEndpoint:
      type: object
      description: Exposed endpoint details
      properties:
        host:
          type: string
          description: Endpoint hostname
          example: api.example.com
        port:
          type: integer
          description: Endpoint port
          example: 443
        scheme:
          type: string
          description: URL scheme
          example: https
        basePath:
          type: string
          description: Base path
          example: /api/v1
        uri:
          type: string
          description: Full URI
          example: https://api.example.com:443/api/v1

    ServiceBinding:
      type: object
      description: Service-specific binding data
      properties:
        endpoints:
          type: array
          description: Exposed endpoints
          items:
            $ref: '#/components/schemas/EndpointStatus'
        image:
          type: string
          description: Container image
          example: registry.example.com/my-namespace/api-service:v1.0.0
        releaseState:
          type: string
          description: Release state
          example: Active

    WebApplicationBinding:
      type: object
      description: Web application-specific binding data
      properties:
        endpoints:
          type: array
          description: Exposed endpoints
          items:
            $ref: '#/components/schemas/EndpointStatus'
        image:
          type: string
          description: Container image
          example: registry.example.com/my-namespace/web-app:v1.0.0
        releaseState:
          type: string
          description: Release state
          example: Active

    ScheduledTaskBinding:
      type: object
      description: Scheduled task-specific binding data
      properties:
        image:
          type: string
          description: Container image
          example: registry.example.com/my-namespace/cron-job:v1.0.0
        releaseState:
          type: string
          description: Release state
          example: Active

    UpdateBindingRequest:
      type: object
      description: Request to update a binding
      required:
        - releaseState
      properties:
        releaseState:
          type: string
          description: Desired release state
          enum: [Active, Suspend, Undeploy]
          example: Active

    # -------------------------------------------------------------------------
    # Component Releases
    # -------------------------------------------------------------------------
    ComponentReleaseList:
      type: object
      description: Paginated list of component releases
      required:
        - items
        - pagination
      properties:
        items:
          type: array
          items:
            $ref: '#/components/schemas/ComponentRelease'
        pagination:
          $ref: '#/components/schemas/Pagination'

    ComponentRelease:
      type: object
      description: |
        ComponentRelease resource (Kubernetes object without kind/apiVersion).
        Immutable snapshot of component state at release time.
      required:
        - metadata
      properties:
        metadata:
          $ref: '#/components/schemas/ObjectMeta'
        spec:
          $ref: '#/components/schemas/ComponentReleaseSpec'
        status:
          readOnly: true
          type: object
          description: ComponentRelease status (currently empty, immutable after creation)

    ComponentReleaseSpec:
      type: object
      description: Desired state of a ComponentRelease
      required:
        - owner
        - componentType
        - workload
      properties:
        owner:
          type: object
          description: Identifies the component and project this release belongs to
          required:
            - projectName
            - componentName
          properties:
            projectName:
              type: string
              description: Parent project name
              example: my-project
            componentName:
              type: string
              description: Parent component name
              example: api-service
        componentType:
          type: object
          description: Frozen ComponentType spec at release time
          additionalProperties: true
        traits:
          type: object
          description: Frozen trait specs at release time (keyed by trait name)
          additionalProperties: true
        componentProfile:
          type: object
          description: Snapshot of component parameters and trait configs
          properties:
            parameters:
              type: object
              description: Component type parameters
              additionalProperties: true
            traits:
              type: array
              description: Component trait instances
              items:
                $ref: '#/components/schemas/ComponentTrait'
        workload:
          type: object
          description: Frozen workload spec at release time
          additionalProperties: true

    # -------------------------------------------------------------------------
    # Release Bindings
    # -------------------------------------------------------------------------
    ReleaseBindingList:
      type: object
      description: Paginated list of release bindings
      required:
        - items
        - pagination
      properties:
        items:
          type: array
          items:
            $ref: '#/components/schemas/ReleaseBinding'
        pagination:
          $ref: '#/components/schemas/Pagination'

    ReleaseBinding:
      type: object
      description: |
        ReleaseBinding resource (Kubernetes object without kind/apiVersion).
        Binds a ComponentRelease to a specific environment.
      required:
        - metadata
      properties:
        metadata:
          $ref: '#/components/schemas/ObjectMeta'
        spec:
          $ref: '#/components/schemas/ReleaseBindingSpec'
        status:
          readOnly: true
          allOf:
            - $ref: '#/components/schemas/ReleaseBindingStatus'

    ReleaseBindingSpec:
      type: object
      description: Desired state of a ReleaseBinding
      required:
        - owner
        - environment
      properties:
        owner:
          type: object
          description: Owner identifies the component and project this ReleaseBinding belongs to
          required:
            - projectName
            - componentName
          properties:
            projectName:
              type: string
              description: Name of the project
              example: my-project
            componentName:
              type: string
              description: Name of the component
              example: api-service
        environment:
          type: string
          description: Target environment name
          example: dev
        releaseName:
          type: string
          description: Reference to component release
          example: v1.0.0
        componentTypeEnvOverrides:
          type: object
          description: Environment-specific ComponentType overrides
          additionalProperties: true
        traitOverrides:
          type: object
          description: Environment-specific trait overrides
          additionalProperties: true
        workloadOverrides:
          $ref: '#/components/schemas/WorkloadOverrides'
        state:
          type: string
          description: Controls the state of the Release created by this binding
          enum: [Active, Undeploy]
          default: Active
          example: Active

    ReleaseBindingStatus:
      type: object
      description: Observed state of a ReleaseBinding
      properties:
        conditions:
          type: array
          description: Latest available observations of the ReleaseBinding's current state
          items:
            $ref: '#/components/schemas/Condition'
        endpoints:
          type: array
          description: Resolved invoke URLs for each named workload endpoint
          items:
            type: object
            required:
              - name
              - invokeURL
            properties:
              name:
                type: string
                description: Endpoint name as defined in the Workload spec
                example: http
              invokeURL:
                type: string
                description: Resolved public URL for this endpoint
                example: https://api-service-dev-default.example.com

    WorkloadOverrides:
      type: object
      description: Environment-specific workload overrides
      properties:
        containers:
          type: object
          description: Container overrides keyed by container name
          additionalProperties:
            $ref: '#/components/schemas/ContainerOverride'

    ContainerOverride:
      type: object
      description: Container-level overrides
      properties:
        env:
          type: array
          items:
            $ref: '#/components/schemas/EnvVar'
        files:
          type: array
          items:
            $ref: '#/components/schemas/FileVar'

    EnvVar:
      type: object
      description: Environment variable
      required:
        - key
      properties:
        key:
          type: string
          description: Variable key/name
          example: DATABASE_URL
        value:
          type: string
          description: Variable value
          example: postgres://localhost:5432/db
        valueFrom:
          $ref: '#/components/schemas/EnvVarValueFrom'

    EnvVarValueFrom:
      type: object
      description: Value source reference
      properties:
        secretRef:
          type: object
          description: Secret reference
          properties:
            name:
              type: string
              description: Secret name
            key:
              type: string
              description: Secret key

    FileVar:
      type: object
      description: File mount variable
      required:
        - key
        - mountPath
      properties:
        key:
          type: string
          description: File key/name
          example: config.yaml
        mountPath:
          type: string
          description: Mount path in container
          example: /app/config
        value:
          type: string
          description: File content
        valueFrom:
          $ref: '#/components/schemas/EnvVarValueFrom'

    # -------------------------------------------------------------------------
    # Release
    # -------------------------------------------------------------------------
    ReleaseList:
      type: object
      description: Paginated list of releases
      required:
        - items
      properties:
        items:
          type: array
          items:
            $ref: '#/components/schemas/Release'
        pagination:
          $ref: '#/components/schemas/Pagination'

    Release:
      type: object
      description: |
        Release resource (Kubernetes object without kind/apiVersion).
        Contains the final Kubernetes manifests deployed to data plane clusters.
      required:
        - metadata
      properties:
        metadata:
          $ref: '#/components/schemas/ObjectMeta'
        spec:
          $ref: '#/components/schemas/ReleaseSpec'
        status:
          readOnly: true
          allOf:
            - $ref: '#/components/schemas/ReleaseStatus'

    ReleaseSpec:
      type: object
      description: Desired state of a Release
      required:
        - owner
        - environmentName
      properties:
        owner:
          type: object
          description: Owner identifies the component and project this Release belongs to
          required:
            - projectName
            - componentName
          properties:
            projectName:
              type: string
              description: Name of the project
              example: my-project
            componentName:
              type: string
              description: Name of the component
              example: api-service
        environmentName:
          type: string
          description: Target environment for this release
          example: dev
        resources:
          type: array
          description: Kubernetes resource templates to apply to the data plane
          items:
            type: object
            required:
              - id
              - object
            properties:
              id:
                type: string
                description: Unique identifier for the resource
              object:
                type: object
                description: Complete Kubernetes resource definition
                additionalProperties: true
        targetPlane:
          type: string
          description: Target plane for deployment
          enum: [dataplane, observabilityplane]
          default: dataplane
          example: dataplane
        interval:
          type: string
          description: Watch interval for stable release resources (e.g. 5m, 30s)
          example: 5m
        progressingInterval:
          type: string
          description: Watch interval for transitioning release resources (e.g. 10s)
          example: 10s

    ReleaseStatus:
      type: object
      description: Observed state of a Release
      properties:
        conditions:
          type: array
          description: Latest available observations of the Release's current state
          items:
            $ref: '#/components/schemas/Condition'
        resources:
          type: array
          description: Resources applied to the data plane with their observed status
          items:
            type: object
            properties:
              id:
                type: string
                description: Resource identifier matching spec.resources
              group:
                type: string
                description: API group of the resource
              version:
                type: string
                description: API version of the resource
              kind:
                type: string
                description: Kind of the resource
              name:
                type: string
                description: Name of the resource in the data plane
              namespace:
                type: string
                description: Namespace of the resource in the data plane
              healthStatus:
                type: string
                description: Health status of the resource
                enum: [Unknown, Progressing, Healthy, Suspended, Degraded]
              status:
                type: object
                description: Full status of the resource from the data plane
                additionalProperties: true

    # -------------------------------------------------------------------------
    # Resource Tree
    # -------------------------------------------------------------------------
    ResourceRef:
      type: object
      description: Reference to a parent resource in the resource tree
      required:
        - version
        - kind
        - name
        - uid
      properties:
        group:
          type: string
          description: API group of the resource
        version:
          type: string
          description: API version of the resource
        kind:
          type: string
          description: Kind of the resource
        namespace:
          type: string
          description: Namespace of the resource
        name:
          type: string
          description: Name of the resource
        uid:
          type: string
          description: UID of the resource

    HealthInfo:
      type: object
      description: Health status for a resource node
      required:
        - status
      properties:
        status:
          type: string
          description: Health status (Healthy, Degraded, Progressing, Unknown, etc.)
        message:
          type: string
          description: Optional human-readable message explaining the health status

    ResourceNode:
      type: object
      description: A single resource in the resource tree
      required:
        - version
        - kind
        - name
        - uid
        - object
      properties:
        group:
          type: string
          description: API group of the resource
        version:
          type: string
          description: API version of the resource
        kind:
          type: string
          description: Kind of the resource
        namespace:
          type: string
          description: Namespace of the resource
        name:
          type: string
          description: Name of the resource
        uid:
          type: string
          description: UID of the resource
        resourceVersion:
          type: string
          description: Resource version from Kubernetes
        createdAt:
          type: string
          format: date-time
          description: Creation timestamp of the resource
        parentRefs:
          type: array
          description: References to parent resources
          items:
            $ref: '#/components/schemas/ResourceRef'
        object:
          type: object
          additionalProperties: true
          description: Full Kubernetes resource object
        health:
          $ref: '#/components/schemas/HealthInfo'

    ResourceTreeResponse:
      type: object
      description: Response containing the resource tree for a release
      required:
        - nodes
      properties:
        nodes:
          type: array
          description: All resource nodes in the tree
          items:
            $ref: '#/components/schemas/ResourceNode'

    # -------------------------------------------------------------------------
    # Deploy/Promote Requests
    # -------------------------------------------------------------------------
    DeployReleaseRequest:
      type: object
      description: Request to deploy a release
      required:
        - releaseName
      properties:
        releaseName:
          type: string
          description: Component release name to deploy
          example: v1.0.0

    PromoteComponentRequest:
      type: object
      description: Request to promote a component between environments
      required:
        - sourceEnv
        - targetEnv
      properties:
        sourceEnv:
          type: string
          description: Source environment name
          example: dev
        targetEnv:
          type: string
          description: Target environment name
          example: staging

    GenerateReleaseRequest:
      type: object
      description: Request to generate an immutable release snapshot from the current component state
      properties:
        releaseName:
          type: string
          description: Optional release name (auto-generated if not provided)
          example: v1.0.0

    # -------------------------------------------------------------------------
    # Authorization Schemas
    # -------------------------------------------------------------------------
    MessageResponse:
      type: object
      description: Simple message response
      required:
        - message
      properties:
        message:
          type: string
          description: Response message
          example: Operation completed successfully

    AuthzClusterRole:
      type: object
      description: |
        Cluster-scoped authorization role (Kubernetes CRD).
        Defines a set of actions that can be assigned to subjects via role bindings.
      required:
        - metadata
      properties:
        metadata:
          $ref: '#/components/schemas/ObjectMeta'
        spec:
          $ref: '#/components/schemas/AuthzClusterRoleSpec'

    AuthzClusterRoleSpec:
      type: object
      description: Specification for a cluster-scoped authorization role
      required:
        - actions
      properties:
        actions:
          type: array
          description: List of actions this role permits
          items:
            type: string
          example: ["project:create", "project:view", "project:delete"]
        description:
          type: string
          description: Human-readable description of the role
          example: Full cluster administration access

    AuthzClusterRoleList:
      type: object
      description: List of cluster-scoped authorization roles
      required:
        - items
      properties:
        items:
          type: array
          items:
            $ref: '#/components/schemas/AuthzClusterRole'

    AuthzRole:
      type: object
      description: |
        Namespace-scoped authorization role (Kubernetes CRD).
        Defines a set of actions that can be assigned to subjects via role bindings within a namespace.
      required:
        - metadata
      properties:
        metadata:
          $ref: '#/components/schemas/ObjectMeta'
        spec:
          $ref: '#/components/schemas/AuthzRoleSpec'

    AuthzRoleSpec:
      type: object
      description: Specification for a namespace-scoped authorization role
      required:
        - actions
      properties:
        actions:
          type: array
          description: List of actions this role permits
          items:
            type: string
          example: ["component:create", "component:view"]
        description:
          type: string
          description: Human-readable description of the role
          example: Developer access within namespace

    AuthzRoleList:
      type: object
      description: List of namespace-scoped authorization roles
      required:
        - items
      properties:
        items:
          type: array
          items:
            $ref: '#/components/schemas/AuthzRole'

    AuthzClusterRoleBinding:
      type: object
      description: |
        Cluster-scoped role binding (Kubernetes CRD).
        Binds a cluster role to a subject identified by an entitlement claim.
      required:
        - metadata
      properties:
        metadata:
          $ref: '#/components/schemas/ObjectMeta'
        spec:
          $ref: '#/components/schemas/AuthzClusterRoleBindingSpec'

    AuthzClusterRoleBindingSpec:
      type: object
      description: Specification for a cluster-scoped role binding
      required:
        - entitlement
        - roleRef
      properties:
        entitlement:
          $ref: '#/components/schemas/AuthzEntitlementClaim'
        roleRef:
          $ref: '#/components/schemas/AuthzRoleRef'
        effect:
          type: string
          description: Policy effect (allow or deny)
          enum: [allow, deny]
          default: allow
          example: allow

    AuthzClusterRoleBindingList:
      type: object
      description: List of cluster-scoped role bindings
      required:
        - items
      properties:
        items:
          type: array
          items:
            $ref: '#/components/schemas/AuthzClusterRoleBinding'

    AuthzRoleBinding:
      type: object
      description: |
        Namespace-scoped role binding (Kubernetes CRD).
        Binds a role to a subject identified by an entitlement claim within a namespace.
      required:
        - metadata
      properties:
        metadata:
          $ref: '#/components/schemas/ObjectMeta'
        spec:
          $ref: '#/components/schemas/AuthzRoleBindingSpec'

    AuthzRoleBindingSpec:
      type: object
      description: Specification for a namespace-scoped role binding
      required:
        - entitlement
        - roleRef
      properties:
        entitlement:
          $ref: '#/components/schemas/AuthzEntitlementClaim'
        roleRef:
          $ref: '#/components/schemas/AuthzRoleRef'
        targetPath:
          $ref: '#/components/schemas/AuthzTargetPath'
        effect:
          type: string
          description: Policy effect (allow or deny)
          enum: [allow, deny]
          default: allow
          example: allow

    AuthzRoleBindingList:
      type: object
      description: List of namespace-scoped role bindings
      required:
        - items
      properties:
        items:
          type: array
          items:
            $ref: '#/components/schemas/AuthzRoleBinding'

    AuthzEntitlementClaim:
      type: object
      description: Entitlement claim-value pair for subject identification
      required:
        - claim
        - value
      properties:
        claim:
          type: string
          description: JWT claim name
          example: groups
        value:
          type: string
          description: Entitlement value
          example: admin-group

    AuthzRoleRef:
      type: object
      description: Reference to an AuthzRole or AuthzClusterRole
      required:
        - kind
        - name
      properties:
        kind:
          type: string
          description: Kind of role (AuthzRole or AuthzClusterRole)
          enum: [AuthzRole, AuthzClusterRole]
          example: AuthzClusterRole
        name:
          type: string
          description: Name of the role
          example: admin

    AuthzTargetPath:
      type: object
      description: Target resource path within a namespace (project/component scope)
      properties:
        project:
          type: string
          description: Project name
          example: my-project
        component:
          type: string
          description: Component name
          example: api-service

    Entitlement:
      type: object
      description: Entitlement with claim and value
      required:
        - claim
        - value
      properties:
        claim:
          type: string
          description: JWT claim name
          example: group
        value:
          type: string
          description: Entitlement value
          example: admin-group

    ResourceHierarchy:
      type: object
      description: Resource hierarchy scope
      properties:
        namespace:
          type: string
          description: Namespace name
          example: my-namespace
        project:
          type: string
          description: Project name
          example: my-project
        component:
          type: string
          description: Component name
          example: api-service

    AuthzContext:
      type: object
      description: Additional context for authorization
      additionalProperties: true

    SubjectContext:
      type: object
      description: Authenticated subject context
      required:
        - type
        - entitlement_claim
        - entitlement_values
      properties:
        type:
          type: string
          description: Subject type
          enum: [user, service_account]
          example: user
        entitlement_claim:
          type: string
          description: Entitlement claim name
          example: group
        entitlement_values:
          type: array
          description: Entitlement values
          items:
            type: string
          example: ["admin-group", "dev-group"]

    Resource:
      type: object
      description: Resource for authorization evaluation
      required:
        - type
        - hierarchy
      properties:
        type:
          type: string
          description: Resource type
          example: component
        id:
          type: string
          description: Resource ID
          example: api-service
        hierarchy:
          $ref: '#/components/schemas/ResourceHierarchy'

    EvaluateRequest:
      type: object
      description: Single authorization evaluation request
      required:
        - resource
        - action
        - subject_context
      properties:
        subject_context:
          $ref: '#/components/schemas/SubjectContext'
        resource:
          $ref: '#/components/schemas/Resource'
        action:
          type: string
          description: Action to evaluate
          example: read
        context:
          $ref: '#/components/schemas/AuthzContext'

    Decision:
      type: object
      description: Authorization decision
      required:
        - decision
      properties:
        decision:
          type: boolean
          description: Authorization result (true = allowed)
          example: true
        context:
          type: object
          description: Additional decision context
          properties:
            reason:
              type: string
              description: Reason for the decision
              example: User has admin role

    BatchEvaluateRequest:
      type: object
      description: Batch authorization evaluation request
      required:
        - requests
      properties:
        requests:
          type: array
          description: List of evaluation requests
          items:
            $ref: '#/components/schemas/EvaluateRequest'

    BatchEvaluateResponse:
      type: object
      description: Batch authorization evaluation response
      required:
        - decisions
      properties:
        decisions:
          type: array
          description: List of decisions (in same order as requests)
          items:
            $ref: '#/components/schemas/Decision'

    ActionCapability:
      type: object
      description: Capabilities for a specific action
      properties:
        allowed:
          type: array
          description: Resources where action is allowed
          items:
            $ref: '#/components/schemas/CapabilityResource'
        denied:
          type: array
          description: Resources where action is denied
          items:
            $ref: '#/components/schemas/CapabilityResource'

    CapabilityResource:
      type: object
      description: Resource with permission details
      properties:
        path:
          type: string
          description: Full resource path
          example: namespace/acme/project/payment
        constraints:
          type: object
          description: Additional instance-level restrictions
          additionalProperties: true

    UserCapabilitiesResponse:
      type: object
      description: User authorization profile response
      properties:
        user:
          $ref: '#/components/schemas/SubjectContext'
        capabilities:
          type: object
          description: Map of action to capabilities
          additionalProperties:
            $ref: '#/components/schemas/ActionCapability'
        evaluatedAt:
          type: string
          format: date-time
          description: Time when capabilities were evaluated
          example: "2025-01-06T10:00:00Z"


    # -------------------------------------------------------------------------
    # Legacy Authz Schemas (kept for legacy handler compatibility)
    # -------------------------------------------------------------------------

    Role:
      type: object
      description: Authorization role with permitted actions (legacy)
      required:
        - name
        - actions
      properties:
        name:
          type: string
          description: Unique role name
          example: admin
        actions:
          type: array
          description: List of actions this role permits
          items:
            type: string
          example: ["read", "write", "delete"]
        namespace:
          type: string
          description: Namespace for namespace-scoped roles, empty for cluster roles
          example: my-namespace
        description:
          type: string
          description: Human-readable description of the role
          example: Full administrative access

    UpdateRoleRequest:
      type: object
      description: Request to update a role's actions (legacy)
      required:
        - actions
      properties:
        actions:
          type: array
          description: New list of actions for the role
          items:
            type: string
          example: ["read", "write"]

    TargetPath:
      type: object
      description: Target resource path within a namespace (project/component only) (legacy)
      properties:
        project:
          type: string
          description: Project name
          example: my-project
        component:
          type: string
          description: Component name
          example: api-service

    RoleEntitlementMapping:
      type: object
      description: Mapping of a role to an entitlement within a scope (legacy)
      required:
        - name
        - role
        - entitlement
        - hierarchy
        - effect
      properties:
        name:
          type: string
          description: Unique mapping name
          example: admin-binding
        role:
          $ref: '#/components/schemas/RoleRef'
        entitlement:
          $ref: '#/components/schemas/Entitlement'
        hierarchy:
          $ref: '#/components/schemas/ResourceHierarchy'
        effect:
          type: string
          description: Policy effect (allow or deny)
          enum: [allow, deny]
          default: allow
          example: allow
        context:
          $ref: '#/components/schemas/AuthzContext'

    UpdateRoleMappingRequest:
      type: object
      description: Request to update a role mapping (legacy)
      required:
        - role
        - entitlement
        - hierarchy
        - effect
      properties:
        role:
          $ref: '#/components/schemas/RoleRef'
        entitlement:
          $ref: '#/components/schemas/Entitlement'
        hierarchy:
          $ref: '#/components/schemas/ResourceHierarchy'
        effect:
          type: string
          description: Policy effect (allow or deny)
          enum: [allow, deny]
          default: allow
          example: allow
        context:
          $ref: '#/components/schemas/AuthzContext'

    ClusterRoleRef:
      type: object
      description: Reference to a cluster role by name only (legacy)
      required:
        - name
      properties:
        name:
          type: string
          description: Cluster role name
          example: admin

    RoleRef:
      type: object
      description: Reference to a role by name and namespace (legacy)
      required:
        - name
      properties:
        name:
          type: string
          description: Role name
          example: developer
        namespace:
          type: string
          description: Namespace for namespace-scoped roles, empty for cluster roles
          example: my-namespace

    CreateClusterRoleRequest:
      type: object
      description: Request to create a cluster-scoped role (legacy)
      required:
        - name
        - actions
      properties:
        name:
          type: string
          description: Unique cluster role name
          example: cluster-admin
        actions:
          type: array
          description: List of actions this role permits
          items:
            type: string
          example: ["read", "write", "delete"]
        description:
          type: string
          description: Human-readable description of the role
          example: Full cluster administration access

    UpdateClusterRoleRequest:
      type: object
      description: Request to update a cluster role (legacy)
      required:
        - actions
      properties:
        actions:
          type: array
          description: List of actions this role permits
          items:
            type: string
          example: ["read", "write"]
        description:
          type: string
          description: Human-readable description of the role
          example: Updated cluster admin role

    CreateClusterRoleBindingRequest:
      type: object
      description: Request to create a cluster-scoped role binding (legacy)
      required:
        - name
        - entitlement
        - role
      properties:
        name:
          type: string
          description: Unique cluster role binding name
          example: admin-binding
        entitlement:
          $ref: '#/components/schemas/Entitlement'
        role:
          type: string
          description: Cluster role name
          example: admin
        effect:
          type: string
          description: Policy effect (allow or deny)
          enum: [allow, deny]
          default: allow
          example: allow

    UpdateClusterRoleBindingRequest:
      type: object
      description: Request to update a cluster role binding (legacy)
      required:
        - entitlement
        - role
        - effect
      properties:
        entitlement:
          $ref: '#/components/schemas/Entitlement'
        role:
          type: string
          description: Cluster role name
          example: admin
        effect:
          type: string
          description: Policy effect (allow or deny)
          enum: [allow, deny]
          default: allow
          example: allow

    CreateNamespaceRoleRequest:
      type: object
      description: Request to create a namespace-scoped role (legacy)
      required:
        - name
        - actions
      properties:
        name:
          type: string
          description: Unique namespace role name
          example: developer
        actions:
          type: array
          description: List of actions this role permits
          items:
            type: string
          example: ["read", "write"]
        description:
          type: string
          description: Human-readable description of the role
          example: Developer access within namespace

    UpdateNamespaceRoleRequest:
      type: object
      description: Request to update a namespace role (legacy)
      required:
        - actions
      properties:
        actions:
          type: array
          description: List of actions this role permits
          items:
            type: string
          example: ["read", "write"]
        description:
          type: string
          description: Human-readable description of the role
          example: Updated developer role

    CreateNamespaceRoleBindingRequest:
      type: object
      description: Request to create a namespace-scoped role binding (legacy)
      required:
        - name
        - entitlement
        - role
      properties:
        name:
          type: string
          description: Unique namespace role binding name
          example: developer-binding
        entitlement:
          $ref: '#/components/schemas/Entitlement'
        role:
          $ref: '#/components/schemas/RoleRef'
        targetPath:
          $ref: '#/components/schemas/TargetPath'
        effect:
          type: string
          description: Policy effect (allow or deny)
          enum: [allow, deny]
          default: allow
          example: allow

    UpdateNamespaceRoleBindingRequest:
      type: object
      description: Request to update a namespace role binding (legacy)
      required:
        - entitlement
        - role
        - targetPath
        - effect
      properties:
        entitlement:
          $ref: '#/components/schemas/Entitlement'
        role:
          $ref: '#/components/schemas/RoleRef'
        targetPath:
          $ref: '#/components/schemas/TargetPath'
        effect:
          type: string
          description: Policy effect (allow or deny)
          enum: [allow, deny]
          default: allow
          example: allow

    # -------------------------------------------------------------------------
    # Webhook Schemas
    # -------------------------------------------------------------------------
    WebhookEventResponse:
      type: object
      description: Response after processing a webhook event
      required:
        - success
        - message
        - triggeredBuilds
      properties:
        success:
          type: boolean
          description: Whether the webhook was processed successfully
          example: true
        message:
          type: string
          description: Status message
          example: Webhook processed successfully
        affectedComponents:
          type: array
          description: List of components affected by this webhook
          items:
            type: string
          example: ["api-service", "web-app"]
        triggeredBuilds:
          type: integer
          description: Number of builds triggered
          example: 2

    # -------------------------------------------------------------------------
    # Resource Apply/Delete Schemas
    # -------------------------------------------------------------------------
    KubernetesResource:
      type: object
      description: Kubernetes resource with OpenChoreo API group
      required:
        - apiVersion
        - kind
        - metadata
      properties:
        apiVersion:
          type: string
          description: API version (must be openchoreo.dev/v1alpha1)
          example: openchoreo.dev/v1alpha1
        kind:
          type: string
          description: Resource kind
          example: Component
        metadata:
          type: object
          description: Resource metadata
          required:
            - name
          properties:
            name:
              type: string
              description: Resource name
              example: my-component
            namespace:
              type: string
              description: Kubernetes namespace
              example: my-namespace
          additionalProperties: true
        spec:
          type: object
          description: Resource specification
          additionalProperties: true

    ApplyResourceResponse:
      type: object
      description: Response from applying a resource
      required:
        - apiVersion
        - kind
        - name
        - operation
      properties:
        apiVersion:
          type: string
          description: Applied resource API version
          example: openchoreo.dev/v1alpha1
        kind:
          type: string
          description: Applied resource kind
          example: Component
        name:
          type: string
          description: Applied resource name
          example: my-component
        namespace:
          type: string
          description: Applied resource namespace
          example: my-namespace
        operation:
          type: string
          description: Operation performed
          enum: [created, updated, unchanged]
          example: created

    DeleteResourceResponse:
      type: object
      description: Response from deleting a resource
      required:
        - apiVersion
        - kind
        - name
        - operation
      properties:
        apiVersion:
          type: string
          description: Deleted resource API version
          example: openchoreo.dev/v1alpha1
        kind:
          type: string
          description: Deleted resource kind
          example: Component
        name:
          type: string
          description: Deleted resource name
          example: my-component
        namespace:
          type: string
          description: Deleted resource namespace
          example: my-namespace
        operation:
          type: string
          description: Operation result
          enum: [deleted, not_found]
          example: deleted

    # -------------------------------------------------------------------------
    # Secret Reference Schemas
    # -------------------------------------------------------------------------
    SecretReferenceList:
      type: object
      description: Paginated list of secret references
      required:
        - items
        - pagination
      properties:
        items:
          type: array
          items:
            $ref: '#/components/schemas/SecretReference'
        pagination:
          $ref: '#/components/schemas/Pagination'

    SecretReference:
      type: object
      description: Secret reference resource
      required:
        - name
        - namespace
        - createdAt
      properties:
        name:
          type: string
          description: Secret reference name
          example: my-secret
        namespace:
          type: string
          description: Kubernetes namespace
          example: my-namespace
        displayName:
          type: string
          description: Human-readable display name
          example: My Secret
        description:
          type: string
          description: Secret reference description
          example: Database credentials
        secretStores:
          type: array
          description: Secret store references
          items:
            $ref: '#/components/schemas/SecretStoreReference'
        refreshInterval:
          type: string
          description: Refresh interval for secret sync
          example: 1h
        data:
          type: array
          description: Secret data sources
          items:
            $ref: '#/components/schemas/SecretDataSource'
        createdAt:
          type: string
          format: date-time
          description: Creation timestamp
          example: "2025-01-06T10:00:00Z"
        lastRefreshTime:
          type: string
          format: date-time
          description: Last refresh time
          example: "2025-01-06T11:00:00Z"
        status:
          type: string
          description: Secret reference status
          example: Ready

    SecretStoreReference:
      type: object
      description: Reference to a secret store
      required:
        - name
        - kind
      properties:
        name:
          type: string
          description: Secret store name
          example: vault-store
        namespace:
          type: string
          description: Secret store namespace
          example: my-namespace
        kind:
          type: string
          description: Secret store kind
          example: SecretStore

    SecretDataSource:
      type: object
      description: Secret data source information
      required:
        - secretKey
        - remoteRef
      properties:
        secretKey:
          type: string
          description: Key in the Kubernetes secret
          example: database-password
        remoteRef:
          $ref: '#/components/schemas/RemoteReference'

    RemoteReference:
      type: object
      description: Remote secret reference
      required:
        - key
      properties:
        key:
          type: string
          description: Key in the external secret store
          example: prod/database/password
        property:
          type: string
          description: Property within the secret
          example: password
        version:
          type: string
          description: Secret version
          example: 1

    # -------------------------------------------------------------------------
    # Workload Schemas
    # -------------------------------------------------------------------------
    WorkloadList:
      type: object
      description: Paginated list of workloads
      required:
        - items
      properties:
        items:
          type: array
          items:
            $ref: '#/components/schemas/Workload'
        pagination:
          $ref: '#/components/schemas/Pagination'

    Workload:
      type: object
      description: |
        Workload resource (Kubernetes object without kind/apiVersion).
        Defines the source code, containers, endpoints and connections for a component.
      required:
        - metadata
      properties:
        metadata:
          $ref: '#/components/schemas/ObjectMeta'
        spec:
          $ref: '#/components/schemas/WorkloadSpec'
        status:
          readOnly: true
          allOf:
            - $ref: '#/components/schemas/WorkloadStatus'

    WorkloadSpec:
      type: object
      description: Desired state of a Workload
      properties:
        owner:
          type: object
          description: Owner reference for the workload
          required:
            - projectName
            - componentName
          properties:
            projectName:
              type: string
              description: Name of the owning project
              example: my-project
            componentName:
              type: string
              description: Name of the owning component
              example: api-service
        container:
          $ref: '#/components/schemas/WorkloadContainer'
        containers:
          type: object
          description: Named container specifications (mutually exclusive with container)
          additionalProperties:
            $ref: '#/components/schemas/WorkloadContainer'
        endpoints:
          type: object
          description: Named endpoint specifications
          additionalProperties:
            $ref: '#/components/schemas/WorkloadEndpoint'
        connections:
          type: object
          description: Named connection specifications
          additionalProperties:
            $ref: '#/components/schemas/WorkloadConnection'

    WorkloadStatus:
      type: object
      description: Observed state of a Workload

    WorkloadContainer:
      type: object
      description: Container specification
      required:
        - image
      properties:
        image:
          type: string
          description: OCI image to run (digest or tag)
          example: registry.example.com/my-namespace/api:v1.0.0
        command:
          type: array
          description: Container entrypoint
          items:
            type: string
        args:
          type: array
          description: Container arguments
          items:
            type: string
        env:
          type: array
          description: Environment variables
          items:
            $ref: '#/components/schemas/EnvVar'
        files:
          type: array
          description: File configurations
          items:
            $ref: '#/components/schemas/FileVar'

    WorkloadEndpoint:
      type: object
      description: Network endpoint specification
      required:
        - type
        - port
      properties:
        visibility:
          type: array
          description: Additional endpoint visibilities beyond implicit project visibility
          items:
            type: string
            enum: [project, namespace, internal, external]
        type:
          type: string
          description: Protocol/technology of the endpoint
          enum: [HTTP, REST, gRPC, GraphQL, Websocket, TCP, UDP]
        port:
          type: integer
          description: Port exposed by the endpoint
          minimum: 1
          maximum: 65535
        targetPort:
          type: integer
          description: Container listening port (defaults to port)
          minimum: 1
          maximum: 65535
        displayName:
          type: string
          description: Human-readable name for the endpoint
        basePath:
          type: string
          description: Base path of the API exposed via the endpoint
        schema:
          type: object
          description: API definition schema
          properties:
            type:
              type: string
            content:
              type: string

    WorkloadConnection:
      type: object
      description: Internal API connection specification
      required:
        - type
        - inject
      properties:
        type:
          type: string
          description: Connection type
          enum: [api]
        params:
          type: object
          description: Connection configuration parameters
          additionalProperties:
            type: string
        inject:
          type: object
          description: How connection details are injected into the workload
          required:
            - env
          properties:
            env:
              type: array
              description: Environment variables to inject
              items:
                type: object
                required:
                  - name
                  - value
                properties:
                  name:
                    type: string
                    description: Environment variable name
                  value:
                    type: string
                    description: Template value using connection properties

    # -------------------------------------------------------------------------
    # Deployment Pipeline Schemas
    # -------------------------------------------------------------------------
    DeploymentPipeline:
      type: object
      description: Deployment pipeline resource
      required:
        - name
        - namespaceName
        - createdAt
      properties:
        name:
          type: string
          description: Pipeline name
          example: default-pipeline
        displayName:
          type: string
          description: Human-readable display name
          example: Default Pipeline
        description:
          type: string
          description: Pipeline description
          example: Standard deployment pipeline with dev, staging, and prod
        namespaceName:
          type: string
          description: Parent namespace name
          example: my-namespace
        createdAt:
          type: string
          format: date-time
          description: Creation timestamp
          example: "2025-01-06T10:00:00Z"
        status:
          type: string
          description: Pipeline status
          example: Ready
        promotionPaths:
          type: array
          description: Promotion paths between environments
          items:
            $ref: '#/components/schemas/PromotionPath'

    PromotionPath:
      type: object
      description: Promotion path between environments
      required:
        - sourceEnvironmentRef
        - targetEnvironmentRefs
      properties:
        sourceEnvironmentRef:
          type: string
          description: Source environment name
          example: dev
        targetEnvironmentRefs:
          type: array
          description: Target environments for promotion
          items:
            $ref: '#/components/schemas/TargetEnvironmentRef'

    TargetEnvironmentRef:
      type: object
      description: Target environment reference with approval settings
      required:
        - name
      properties:
        name:
          type: string
          description: Target environment name
          example: staging
        requiresApproval:
          type: boolean
          description: Whether promotion requires approval
          example: false
        isManualApprovalRequired:
          type: boolean
          description: Whether manual approval is required
          example: true
