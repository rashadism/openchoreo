[request_definition]
# sub: group, service account etc
# hierarchical resource path (e.g., "org/acme/ou/finance/project/p1/component/c1")
# act: action string (e.g., "component:create", "deployment:read")
# ctx: context JSON
r = sub, resource, act, ctx

[policy_definition]
# sub: subject 
# resource: resource prefix for hierarchical matching
# role: role name
# eft: allow / deny
# ctx: context JSON
p = sub, resource, role, eft, ctx

[role_definition]
# role to action mapping 
# Format: g, <role>, <action>
g = _, _

[policy_effect]
e = some(where (p.eft == allow)) && !some(where (p.eft == deny))

[matchers]
m = r.sub == p.sub && resourceMatch(r.resource, p.resource) && g(p.role, r.act) && ctxMatch(r.ctx, p.ctx)